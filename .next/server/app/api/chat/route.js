"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "better-sqlite3":
/*!*********************************!*\
  !*** external "better-sqlite3" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("better-sqlite3");

/***/ }),

/***/ "ffmpeg-static":
/*!********************************!*\
  !*** external "ffmpeg-static" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("ffmpeg-static");

/***/ }),

/***/ "jszip":
/*!************************!*\
  !*** external "jszip" ***!
  \************************/
/***/ ((module) => {

module.exports = require("jszip");

/***/ }),

/***/ "mammoth":
/*!**************************!*\
  !*** external "mammoth" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mammoth");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "onnxruntime-node":
/*!***********************************!*\
  !*** external "onnxruntime-node" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("onnxruntime-node");

/***/ }),

/***/ "pdf-parse":
/*!****************************!*\
  !*** external "pdf-parse" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("pdf-parse");

/***/ }),

/***/ "sharp":
/*!************************!*\
  !*** external "sharp" ***!
  \************************/
/***/ ((module) => {

module.exports = require("sharp");

/***/ }),

/***/ "tesseract.js":
/*!*******************************!*\
  !*** external "tesseract.js" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("tesseract.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "node:child_process":
/*!*************************************!*\
  !*** external "node:child_process" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("node:child_process");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:fs/promises":
/*!***********************************!*\
  !*** external "node:fs/promises" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("node:fs/promises");

/***/ }),

/***/ "node:os":
/*!**************************!*\
  !*** external "node:os" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:os");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:path");

/***/ }),

/***/ "node:util":
/*!****************************!*\
  !*** external "node:util" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:util");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "perf_hooks":
/*!*****************************!*\
  !*** external "perf_hooks" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("perf_hooks");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_komar_Desktop_docs_chat_master_docs_chat_master_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\komar\\\\Desktop\\\\docs-chat-master\\\\docs-chat-master\\\\app\\\\api\\\\chat\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_komar_Desktop_docs_chat_master_docs_chat_master_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNrb21hciU1Q0Rlc2t0b3AlNUNkb2NzLWNoYXQtbWFzdGVyJTVDZG9jcy1jaGF0LW1hc3RlciU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDa29tYXIlNUNEZXNrdG9wJTVDZG9jcy1jaGF0LW1hc3RlciU1Q2RvY3MtY2hhdC1tYXN0ZXImaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3VDO0FBQ3BIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZG9jcy1jaGF0LW5leHQvPzViNzAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxca29tYXJcXFxcRGVza3RvcFxcXFxkb2NzLWNoYXQtbWFzdGVyXFxcXGRvY3MtY2hhdC1tYXN0ZXJcXFxcYXBwXFxcXGFwaVxcXFxjaGF0XFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jaGF0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2hhdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY2hhdC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXGtvbWFyXFxcXERlc2t0b3BcXFxcZG9jcy1jaGF0LW1hc3RlclxcXFxkb2NzLWNoYXQtbWFzdGVyXFxcXGFwcFxcXFxhcGlcXFxcY2hhdFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2hhdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/_state.ts":
/*!***************************!*\
  !*** ./app/api/_state.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   chunker: () => (/* binding */ chunker),\n/* harmony export */   mediaFiles: () => (/* binding */ mediaFiles),\n/* harmony export */   sessions: () => (/* binding */ sessions),\n/* harmony export */   store: () => (/* binding */ store)\n/* harmony export */ });\n/* harmony import */ var _lib_settings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/settings */ \"(rsc)/./lib/settings.ts\");\n/* harmony import */ var _lib_textChunker__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/textChunker */ \"(rsc)/./lib/textChunker.ts\");\n/* harmony import */ var _lib_vectorStore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/vectorStore */ \"(rsc)/./lib/vectorStore.ts\");\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! node:path */ \"node:path\");\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(node_path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var node_fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! node:fs */ \"node:fs\");\n/* harmony import */ var node_fs__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(node_fs__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nconst chunker = new _lib_textChunker__WEBPACK_IMPORTED_MODULE_1__.TextChunker(_lib_settings__WEBPACK_IMPORTED_MODULE_0__.settings.MAX_CHUNK_SIZE, _lib_settings__WEBPACK_IMPORTED_MODULE_0__.settings.CHUNK_OVERLAP);\nconst defaultDbPath = process.env.SQLITE_PATH || node_path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \"data\", \"index.sqlite\");\ntry {\n    const dir = node_path__WEBPACK_IMPORTED_MODULE_3___default().dirname(defaultDbPath);\n    if (!node_fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(dir)) {\n        node_fs__WEBPACK_IMPORTED_MODULE_4___default().mkdirSync(dir, {\n            recursive: true\n        });\n    }\n} catch  {}\nconst store = new _lib_vectorStore__WEBPACK_IMPORTED_MODULE_2__.VectorStore(_lib_settings__WEBPACK_IMPORTED_MODULE_0__.settings.EMBEDDING_MODEL, defaultDbPath);\nconst sessions = new Map();\nconst mediaFiles = new Map(); // Store media files by ID\n// Create uploads directory if it doesn't exist\nconst uploadsDir = node_path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \"uploads\");\ntry {\n    if (!node_fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(uploadsDir)) {\n        node_fs__WEBPACK_IMPORTED_MODULE_4___default().mkdirSync(uploadsDir, {\n            recursive: true\n        });\n    }\n} catch  {}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL19zdGF0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUEwQztBQUNNO0FBQ0E7QUFDbkI7QUFDSjtBQVlsQixNQUFNSyxVQUFVLElBQUlKLHlEQUFXQSxDQUFDRCxtREFBUUEsQ0FBQ00sY0FBYyxFQUFFTixtREFBUUEsQ0FBQ08sYUFBYSxFQUFFO0FBQ3hGLE1BQU1DLGdCQUFnQkMsUUFBUUMsR0FBRyxDQUFDQyxXQUFXLElBQUlSLHFEQUFTLENBQUNNLFFBQVFJLEdBQUcsSUFBSSxRQUFRO0FBQ2xGLElBQUk7SUFDRixNQUFNQyxNQUFNWCx3REFBWSxDQUFDSztJQUN6QixJQUFJLENBQUNKLHlEQUFhLENBQUNVLE1BQU07UUFDdkJWLHdEQUFZLENBQUNVLEtBQUs7WUFBRUksV0FBVztRQUFLO0lBQ3RDO0FBQ0YsRUFBRSxPQUFNLENBQUM7QUFDRixNQUFNQyxRQUFRLElBQUlqQix5REFBV0EsQ0FBQ0YsbURBQVFBLENBQUNvQixlQUFlLEVBQUVaLGVBQWU7QUFDdkUsTUFBTWEsV0FBVyxJQUFJQyxNQUE2QjtBQUNsRCxNQUFNQyxhQUFhLElBQUlELE1BQXlCLENBQUMsMEJBQTBCO0FBRWxGLCtDQUErQztBQUMvQyxNQUFNRSxhQUFhckIscURBQVMsQ0FBQ00sUUFBUUksR0FBRyxJQUFJO0FBQzVDLElBQUk7SUFDRixJQUFJLENBQUNULHlEQUFhLENBQUNvQixhQUFhO1FBQzlCcEIsd0RBQVksQ0FBQ29CLFlBQVk7WUFBRU4sV0FBVztRQUFLO0lBQzdDO0FBQ0YsRUFBRSxPQUFNLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kb2NzLWNoYXQtbmV4dC8uL2FwcC9hcGkvX3N0YXRlLnRzPzRhYzYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tIFwiQC9saWIvc2V0dGluZ3NcIjtcclxuaW1wb3J0IHsgVGV4dENodW5rZXIgfSBmcm9tIFwiQC9saWIvdGV4dENodW5rZXJcIjtcclxuaW1wb3J0IHsgVmVjdG9yU3RvcmUgfSBmcm9tIFwiQC9saWIvdmVjdG9yU3RvcmVcIjtcclxuaW1wb3J0IHBhdGggZnJvbSBcIm5vZGU6cGF0aFwiO1xyXG5pbXBvcnQgZnMgZnJvbSBcIm5vZGU6ZnNcIjtcclxuXHJcbmV4cG9ydCB0eXBlIENoYXRNZXNzYWdlID0geyByb2xlOiBcInVzZXJcIiB8IFwiYXNzaXN0YW50XCI7IGNvbnRlbnQ6IHN0cmluZyB9O1xyXG5cclxuZXhwb3J0IHR5cGUgTWVkaWFGaWxlID0ge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgZmlsZVBhdGg6IHN0cmluZztcclxuICBtaW1lVHlwZTogc3RyaW5nO1xyXG4gIG9yaWdpbmFsTmFtZTogc3RyaW5nO1xyXG4gIHR5cGU6IFwiaW1hZ2VcIiB8IFwidmlkZW9cIiB8IFwiYXVkaW9cIjtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBjaHVua2VyID0gbmV3IFRleHRDaHVua2VyKHNldHRpbmdzLk1BWF9DSFVOS19TSVpFLCBzZXR0aW5ncy5DSFVOS19PVkVSTEFQKTtcclxuY29uc3QgZGVmYXVsdERiUGF0aCA9IHByb2Nlc3MuZW52LlNRTElURV9QQVRIIHx8IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBcImRhdGFcIiwgXCJpbmRleC5zcWxpdGVcIik7XHJcbnRyeSB7XHJcbiAgY29uc3QgZGlyID0gcGF0aC5kaXJuYW1lKGRlZmF1bHREYlBhdGgpO1xyXG4gIGlmICghZnMuZXhpc3RzU3luYyhkaXIpKSB7XHJcbiAgICBmcy5ta2RpclN5bmMoZGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcclxuICB9XHJcbn0gY2F0Y2gge31cclxuZXhwb3J0IGNvbnN0IHN0b3JlID0gbmV3IFZlY3RvclN0b3JlKHNldHRpbmdzLkVNQkVERElOR19NT0RFTCwgZGVmYXVsdERiUGF0aCk7XHJcbmV4cG9ydCBjb25zdCBzZXNzaW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBDaGF0TWVzc2FnZVtdPigpO1xyXG5leHBvcnQgY29uc3QgbWVkaWFGaWxlcyA9IG5ldyBNYXA8c3RyaW5nLCBNZWRpYUZpbGU+KCk7IC8vIFN0b3JlIG1lZGlhIGZpbGVzIGJ5IElEXHJcblxyXG4vLyBDcmVhdGUgdXBsb2FkcyBkaXJlY3RvcnkgaWYgaXQgZG9lc24ndCBleGlzdFxyXG5jb25zdCB1cGxvYWRzRGlyID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIFwidXBsb2Fkc1wiKTtcclxudHJ5IHtcclxuICBpZiAoIWZzLmV4aXN0c1N5bmModXBsb2Fkc0RpcikpIHtcclxuICAgIGZzLm1rZGlyU3luYyh1cGxvYWRzRGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcclxuICB9XHJcbn0gY2F0Y2gge31cclxuXHJcbiJdLCJuYW1lcyI6WyJzZXR0aW5ncyIsIlRleHRDaHVua2VyIiwiVmVjdG9yU3RvcmUiLCJwYXRoIiwiZnMiLCJjaHVua2VyIiwiTUFYX0NIVU5LX1NJWkUiLCJDSFVOS19PVkVSTEFQIiwiZGVmYXVsdERiUGF0aCIsInByb2Nlc3MiLCJlbnYiLCJTUUxJVEVfUEFUSCIsImpvaW4iLCJjd2QiLCJkaXIiLCJkaXJuYW1lIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsInN0b3JlIiwiRU1CRURESU5HX01PREVMIiwic2Vzc2lvbnMiLCJNYXAiLCJtZWRpYUZpbGVzIiwidXBsb2Fkc0RpciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/_state.ts\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../_state */ \"(rsc)/./app/api/_state.ts\");\n/* harmony import */ var _lib_gemini__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/gemini */ \"(rsc)/./lib/gemini.ts\");\n/* harmony import */ var _lib_documentProcessor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/documentProcessor */ \"(rsc)/./lib/documentProcessor.ts\");\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! node:fs/promises */ \"node:fs/promises\");\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(node_fs_promises__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nconst runtime = \"nodejs\";\nasync function POST(req) {\n    const body = await req.json().catch(()=>({}));\n    const { session_id, query, top_k = 5 } = body;\n    if (!query || !query.trim()) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        detail: \"Query cannot be empty\"\n    }, {\n        status: 400\n    });\n    if (!_state__WEBPACK_IMPORTED_MODULE_1__.sessions.has(session_id)) {\n        _state__WEBPACK_IMPORTED_MODULE_1__.sessions.set(session_id, []);\n    }\n    const history = _state__WEBPACK_IMPORTED_MODULE_1__.sessions.get(session_id);\n    history.push({\n        role: \"user\",\n        content: query\n    });\n    try {\n        // Collect all media files (images/videos) for visual analysis\n        const mediaToInclude = [];\n        for (const [id, media] of _state__WEBPACK_IMPORTED_MODULE_1__.mediaFiles.entries()){\n            if (media.type === \"image\" || media.type === \"video\") {\n                mediaToInclude.push({\n                    filePath: media.filePath,\n                    mimeType: media.mimeType\n                });\n            }\n        }\n        // If we have media files, always use them with Gemini Vision\n        if (mediaToInclude.length > 0) {\n            // For videos, extract frames\n            const finalMediaFiles = [];\n            for (const media of mediaToInclude){\n                if (media.mimeType.startsWith(\"video/\")) {\n                    try {\n                        const frames = await (0,_lib_documentProcessor__WEBPACK_IMPORTED_MODULE_3__.extractVideoFrames)(media.filePath, 5);\n                        // Convert frames to base64 and add as images\n                        for (const framePath of frames){\n                            try {\n                                const frameData = await node_fs_promises__WEBPACK_IMPORTED_MODULE_4___default().readFile(framePath);\n                                const base64Data = frameData.toString(\"base64\");\n                                // Create temporary file reference for Gemini\n                                finalMediaFiles.push({\n                                    filePath: framePath,\n                                    mimeType: \"image/jpeg\"\n                                });\n                            } catch (e) {\n                                console.warn(\"Failed to read video frame:\", e);\n                            }\n                        }\n                    } catch (e) {\n                        console.warn(\"Failed to extract video frames, using video file directly:\", e);\n                        finalMediaFiles.push(media);\n                    }\n                } else {\n                    finalMediaFiles.push(media);\n                }\n            }\n            // Build prompt with context if available\n            let prompt = query;\n            const stats = _state__WEBPACK_IMPORTED_MODULE_1__.store.getStats();\n            if (stats.index_size > 0) {\n                const results = await _state__WEBPACK_IMPORTED_MODULE_1__.store.search(query, top_k);\n                if (results.length > 0) {\n                    const contexts = results.map((c, i)=>`[Context ${i + 1}]:\\n${c.chunk.text || \"\"}\\n`).join(\"\\n\");\n                    const hist = history.slice(-5).map((m)=>`${m.role === \"user\" ? \"User\" : \"Assistant\"}: ${m.content}`).join(\"\\n\");\n                    prompt = `${hist ? `CONVERSATION HISTORY:\\n${hist}\\n\\n` : \"\"}USER QUESTION: ${query}\\n\\nDOCUMENT CONTEXT:\\n${contexts}\\n\\nANSWER:`;\n                }\n            } else {\n                // No text context, but we have media - use simple prompt\n                const hist = history.slice(-5).map((m)=>`${m.role === \"user\" ? \"User\" : \"Assistant\"}: ${m.content}`).join(\"\\n\");\n                prompt = `${hist ? `CONVERSATION HISTORY:\\n${hist}\\n\\n` : \"\"}USER QUESTION: ${query}\\n\\nPlease analyze the ${finalMediaFiles.length > 1 ? `${finalMediaFiles.length} images/frames` : \"image/frame\"} provided and answer based on what you see.\\n\\nANSWER:`;\n            }\n            const answer = await (0,_lib_gemini__WEBPACK_IMPORTED_MODULE_2__.generateWithGemini)(prompt, finalMediaFiles.length > 0 ? finalMediaFiles : mediaToInclude);\n            history.push({\n                role: \"assistant\",\n                content: answer\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                session_id,\n                query,\n                response: answer,\n                relevant_chunks: [],\n                chunk_count: 0,\n                media_analyzed: mediaToInclude.length\n            });\n        }\n        // Fallback to text-only RAG if no media files\n        if (_state__WEBPACK_IMPORTED_MODULE_1__.store.getStats().index_size === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                detail: \"No documents uploaded. Please upload a document first.\"\n            }, {\n                status: 400\n            });\n        }\n        const results = await _state__WEBPACK_IMPORTED_MODULE_1__.store.search(query, top_k);\n        if (!results.length) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                session_id,\n                query,\n                response: \"I couldn't find relevant information in the document to answer your question.\",\n                relevant_chunks: [],\n                chunk_count: 0\n            });\n        }\n        const prompt = (0,_lib_gemini__WEBPACK_IMPORTED_MODULE_2__.buildRagPrompt)(query, results.map((r)=>({\n                text: r.chunk.text\n            })), history);\n        const answer = await (0,_lib_gemini__WEBPACK_IMPORTED_MODULE_2__.generateWithGemini)(prompt);\n        history.push({\n            role: \"assistant\",\n            content: answer\n        });\n        const chunk_info = results.map((r)=>({\n                id: r.chunk.id,\n                text: r.chunk.text.length > 200 ? r.chunk.text.slice(0, 200) + \"...\" : r.chunk.text,\n                score: r.score\n            }));\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            session_id,\n            query,\n            response: answer,\n            relevant_chunks: chunk_info,\n            chunk_count: results.length\n        });\n    } catch (e) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            detail: `Error generating response: ${e.message || e}`\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Qkk7WUFBWUgsYUFBYWYsUUFBUWhCLE1BQU07UUFBQztJQUMzSCxFQUFFLE9BQU9TLEdBQVE7UUFDZixPQUFPM0MscURBQVlBLENBQUNZLElBQUksQ0FBQztZQUFFTSxRQUFRLENBQUMsMkJBQTJCLEVBQUV5QixFQUFFMkIsT0FBTyxJQUFJM0IsRUFBRSxDQUFDO1FBQUMsR0FBRztZQUFFeEIsUUFBUTtRQUFJO0lBQ3JHO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kb2NzLWNoYXQtbmV4dC8uL2FwcC9hcGkvY2hhdC9yb3V0ZS50cz9kZTQ2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xyXG5pbXBvcnQgeyBzZXNzaW9ucywgc3RvcmUsIG1lZGlhRmlsZXMgfSBmcm9tIFwiLi4vX3N0YXRlXCI7XHJcbmltcG9ydCB7IGJ1aWxkUmFnUHJvbXB0LCBnZW5lcmF0ZVdpdGhHZW1pbmkgfSBmcm9tIFwiQC9saWIvZ2VtaW5pXCI7XHJcbmltcG9ydCB7IGV4dHJhY3RWaWRlb0ZyYW1lcyB9IGZyb20gXCJAL2xpYi9kb2N1bWVudFByb2Nlc3NvclwiO1xyXG5pbXBvcnQgZnMgZnJvbSBcIm5vZGU6ZnMvcHJvbWlzZXNcIjtcclxuXHJcbnR5cGUgQ2hhdFJlcXVlc3QgPSB7IHNlc3Npb25faWQ6IHN0cmluZzsgcXVlcnk6IHN0cmluZzsgdG9wX2s/OiBudW1iZXIgfTtcclxuXHJcbmV4cG9ydCBjb25zdCBydW50aW1lID0gXCJub2RlanNcIjtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogUmVxdWVzdCkge1xyXG4gIGNvbnN0IGJvZHkgPSAoYXdhaXQgcmVxLmpzb24oKS5jYXRjaCgoKSA9PiAoe30pKSkgYXMgQ2hhdFJlcXVlc3Q7XHJcbiAgY29uc3QgeyBzZXNzaW9uX2lkLCBxdWVyeSwgdG9wX2sgPSA1IH0gPSBib2R5O1xyXG4gIGlmICghcXVlcnkgfHwgIXF1ZXJ5LnRyaW0oKSkgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZGV0YWlsOiBcIlF1ZXJ5IGNhbm5vdCBiZSBlbXB0eVwiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XHJcblxyXG4gIGlmICghc2Vzc2lvbnMuaGFzKHNlc3Npb25faWQpKSB7XHJcbiAgICBzZXNzaW9ucy5zZXQoc2Vzc2lvbl9pZCwgW10pO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgaGlzdG9yeSA9IHNlc3Npb25zLmdldChzZXNzaW9uX2lkKSE7XHJcbiAgaGlzdG9yeS5wdXNoKHsgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IHF1ZXJ5IH0pO1xyXG5cclxuICB0cnkge1xyXG4gICAgLy8gQ29sbGVjdCBhbGwgbWVkaWEgZmlsZXMgKGltYWdlcy92aWRlb3MpIGZvciB2aXN1YWwgYW5hbHlzaXNcclxuICAgIGNvbnN0IG1lZGlhVG9JbmNsdWRlOiB7IGZpbGVQYXRoOiBzdHJpbmc7IG1pbWVUeXBlOiBzdHJpbmcgfVtdID0gW107XHJcbiAgICBmb3IgKGNvbnN0IFtpZCwgbWVkaWFdIG9mIG1lZGlhRmlsZXMuZW50cmllcygpKSB7XHJcbiAgICAgIGlmIChtZWRpYS50eXBlID09PSBcImltYWdlXCIgfHwgbWVkaWEudHlwZSA9PT0gXCJ2aWRlb1wiKSB7XHJcbiAgICAgICAgbWVkaWFUb0luY2x1ZGUucHVzaCh7IGZpbGVQYXRoOiBtZWRpYS5maWxlUGF0aCwgbWltZVR5cGU6IG1lZGlhLm1pbWVUeXBlIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSWYgd2UgaGF2ZSBtZWRpYSBmaWxlcywgYWx3YXlzIHVzZSB0aGVtIHdpdGggR2VtaW5pIFZpc2lvblxyXG4gICAgaWYgKG1lZGlhVG9JbmNsdWRlLmxlbmd0aCA+IDApIHtcclxuICAgICAgLy8gRm9yIHZpZGVvcywgZXh0cmFjdCBmcmFtZXNcclxuICAgICAgY29uc3QgZmluYWxNZWRpYUZpbGVzOiB7IGZpbGVQYXRoOiBzdHJpbmc7IG1pbWVUeXBlOiBzdHJpbmcgfVtdID0gW107XHJcbiAgICAgIGZvciAoY29uc3QgbWVkaWEgb2YgbWVkaWFUb0luY2x1ZGUpIHtcclxuICAgICAgICBpZiAobWVkaWEubWltZVR5cGUuc3RhcnRzV2l0aCgndmlkZW8vJykpIHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZyYW1lcyA9IGF3YWl0IGV4dHJhY3RWaWRlb0ZyYW1lcyhtZWRpYS5maWxlUGF0aCwgNSk7XHJcbiAgICAgICAgICAgIC8vIENvbnZlcnQgZnJhbWVzIHRvIGJhc2U2NCBhbmQgYWRkIGFzIGltYWdlc1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGZyYW1lUGF0aCBvZiBmcmFtZXMpIHtcclxuICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZnJhbWVEYXRhID0gYXdhaXQgZnMucmVhZEZpbGUoZnJhbWVQYXRoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NERhdGEgPSBmcmFtZURhdGEudG9TdHJpbmcoJ2Jhc2U2NCcpO1xyXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRlbXBvcmFyeSBmaWxlIHJlZmVyZW5jZSBmb3IgR2VtaW5pXHJcbiAgICAgICAgICAgICAgICBmaW5hbE1lZGlhRmlsZXMucHVzaCh7IFxyXG4gICAgICAgICAgICAgICAgICBmaWxlUGF0aDogZnJhbWVQYXRoLCBcclxuICAgICAgICAgICAgICAgICAgbWltZVR5cGU6ICdpbWFnZS9qcGVnJyBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byByZWFkIHZpZGVvIGZyYW1lOlwiLCBlKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiRmFpbGVkIHRvIGV4dHJhY3QgdmlkZW8gZnJhbWVzLCB1c2luZyB2aWRlbyBmaWxlIGRpcmVjdGx5OlwiLCBlKTtcclxuICAgICAgICAgICAgZmluYWxNZWRpYUZpbGVzLnB1c2gobWVkaWEpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBmaW5hbE1lZGlhRmlsZXMucHVzaChtZWRpYSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBCdWlsZCBwcm9tcHQgd2l0aCBjb250ZXh0IGlmIGF2YWlsYWJsZVxyXG4gICAgICBsZXQgcHJvbXB0ID0gcXVlcnk7XHJcbiAgICAgIGNvbnN0IHN0YXRzID0gc3RvcmUuZ2V0U3RhdHMoKTtcclxuICAgICAgaWYgKHN0YXRzLmluZGV4X3NpemUgPiAwKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHN0b3JlLnNlYXJjaChxdWVyeSwgdG9wX2spO1xyXG4gICAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIGNvbnN0IGNvbnRleHRzID0gcmVzdWx0cy5tYXAoKGMsIGkpID0+IGBbQ29udGV4dCAke2kgKyAxfV06XFxuJHtjLmNodW5rLnRleHQgfHwgXCJcIn1cXG5gKS5qb2luKFwiXFxuXCIpO1xyXG4gICAgICAgICAgY29uc3QgaGlzdCA9IGhpc3Rvcnkuc2xpY2UoLTUpLm1hcChtID0+IGAke20ucm9sZSA9PT0gXCJ1c2VyXCIgPyBcIlVzZXJcIiA6IFwiQXNzaXN0YW50XCJ9OiAke20uY29udGVudH1gKS5qb2luKFwiXFxuXCIpO1xyXG4gICAgICAgICAgcHJvbXB0ID0gYCR7aGlzdCA/IGBDT05WRVJTQVRJT04gSElTVE9SWTpcXG4ke2hpc3R9XFxuXFxuYCA6IFwiXCJ9VVNFUiBRVUVTVElPTjogJHtxdWVyeX1cXG5cXG5ET0NVTUVOVCBDT05URVhUOlxcbiR7Y29udGV4dHN9XFxuXFxuQU5TV0VSOmA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIE5vIHRleHQgY29udGV4dCwgYnV0IHdlIGhhdmUgbWVkaWEgLSB1c2Ugc2ltcGxlIHByb21wdFxyXG4gICAgICAgIGNvbnN0IGhpc3QgPSBoaXN0b3J5LnNsaWNlKC01KS5tYXAobSA9PiBgJHttLnJvbGUgPT09IFwidXNlclwiID8gXCJVc2VyXCIgOiBcIkFzc2lzdGFudFwifTogJHttLmNvbnRlbnR9YCkuam9pbihcIlxcblwiKTtcclxuICAgICAgICBwcm9tcHQgPSBgJHtoaXN0ID8gYENPTlZFUlNBVElPTiBISVNUT1JZOlxcbiR7aGlzdH1cXG5cXG5gIDogXCJcIn1VU0VSIFFVRVNUSU9OOiAke3F1ZXJ5fVxcblxcblBsZWFzZSBhbmFseXplIHRoZSAke2ZpbmFsTWVkaWFGaWxlcy5sZW5ndGggPiAxID8gYCR7ZmluYWxNZWRpYUZpbGVzLmxlbmd0aH0gaW1hZ2VzL2ZyYW1lc2AgOiBcImltYWdlL2ZyYW1lXCJ9IHByb3ZpZGVkIGFuZCBhbnN3ZXIgYmFzZWQgb24gd2hhdCB5b3Ugc2VlLlxcblxcbkFOU1dFUjpgO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBhbnN3ZXIgPSBhd2FpdCBnZW5lcmF0ZVdpdGhHZW1pbmkocHJvbXB0LCBmaW5hbE1lZGlhRmlsZXMubGVuZ3RoID4gMCA/IGZpbmFsTWVkaWFGaWxlcyA6IG1lZGlhVG9JbmNsdWRlKTtcclxuICAgICAgaGlzdG9yeS5wdXNoKHsgcm9sZTogXCJhc3Npc3RhbnRcIiwgY29udGVudDogYW5zd2VyIH0pO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcclxuICAgICAgICBzZXNzaW9uX2lkLCBcclxuICAgICAgICBxdWVyeSwgXHJcbiAgICAgICAgcmVzcG9uc2U6IGFuc3dlciwgXHJcbiAgICAgICAgcmVsZXZhbnRfY2h1bmtzOiBbXSwgXHJcbiAgICAgICAgY2h1bmtfY291bnQ6IDAsXHJcbiAgICAgICAgbWVkaWFfYW5hbHl6ZWQ6IG1lZGlhVG9JbmNsdWRlLmxlbmd0aFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBGYWxsYmFjayB0byB0ZXh0LW9ubHkgUkFHIGlmIG5vIG1lZGlhIGZpbGVzXHJcbiAgICBpZiAoc3RvcmUuZ2V0U3RhdHMoKS5pbmRleF9zaXplID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGRldGFpbDogXCJObyBkb2N1bWVudHMgdXBsb2FkZWQuIFBsZWFzZSB1cGxvYWQgYSBkb2N1bWVudCBmaXJzdC5cIiB9LCB7IHN0YXR1czogNDAwIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBzdG9yZS5zZWFyY2gocXVlcnksIHRvcF9rKTtcclxuICAgIGlmICghcmVzdWx0cy5sZW5ndGgpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc2Vzc2lvbl9pZCwgcXVlcnksIHJlc3BvbnNlOiBcIkkgY291bGRuJ3QgZmluZCByZWxldmFudCBpbmZvcm1hdGlvbiBpbiB0aGUgZG9jdW1lbnQgdG8gYW5zd2VyIHlvdXIgcXVlc3Rpb24uXCIsIHJlbGV2YW50X2NodW5rczogW10sIGNodW5rX2NvdW50OiAwIH0pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcHJvbXB0ID0gYnVpbGRSYWdQcm9tcHQocXVlcnksIHJlc3VsdHMubWFwKHIgPT4gKHsgdGV4dDogci5jaHVuay50ZXh0IH0pKSwgaGlzdG9yeSk7XHJcbiAgICBjb25zdCBhbnN3ZXIgPSBhd2FpdCBnZW5lcmF0ZVdpdGhHZW1pbmkocHJvbXB0KTtcclxuICAgIGhpc3RvcnkucHVzaCh7IHJvbGU6IFwiYXNzaXN0YW50XCIsIGNvbnRlbnQ6IGFuc3dlciB9KTtcclxuICAgIGNvbnN0IGNodW5rX2luZm8gPSByZXN1bHRzLm1hcChyID0+ICh7IGlkOiByLmNodW5rLmlkLCB0ZXh0OiByLmNodW5rLnRleHQubGVuZ3RoID4gMjAwID8gci5jaHVuay50ZXh0LnNsaWNlKDAsIDIwMCkgKyBcIi4uLlwiIDogci5jaHVuay50ZXh0LCBzY29yZTogci5zY29yZSB9KSk7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzZXNzaW9uX2lkLCBxdWVyeSwgcmVzcG9uc2U6IGFuc3dlciwgcmVsZXZhbnRfY2h1bmtzOiBjaHVua19pbmZvLCBjaHVua19jb3VudDogcmVzdWx0cy5sZW5ndGggfSk7XHJcbiAgfSBjYXRjaCAoZTogYW55KSB7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBkZXRhaWw6IGBFcnJvciBnZW5lcmF0aW5nIHJlc3BvbnNlOiAke2UubWVzc2FnZSB8fCBlfWAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcclxuICB9XHJcbn1cclxuXHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJzZXNzaW9ucyIsInN0b3JlIiwibWVkaWFGaWxlcyIsImJ1aWxkUmFnUHJvbXB0IiwiZ2VuZXJhdGVXaXRoR2VtaW5pIiwiZXh0cmFjdFZpZGVvRnJhbWVzIiwiZnMiLCJydW50aW1lIiwiUE9TVCIsInJlcSIsImJvZHkiLCJqc29uIiwiY2F0Y2giLCJzZXNzaW9uX2lkIiwicXVlcnkiLCJ0b3BfayIsInRyaW0iLCJkZXRhaWwiLCJzdGF0dXMiLCJoYXMiLCJzZXQiLCJoaXN0b3J5IiwiZ2V0IiwicHVzaCIsInJvbGUiLCJjb250ZW50IiwibWVkaWFUb0luY2x1ZGUiLCJpZCIsIm1lZGlhIiwiZW50cmllcyIsInR5cGUiLCJmaWxlUGF0aCIsIm1pbWVUeXBlIiwibGVuZ3RoIiwiZmluYWxNZWRpYUZpbGVzIiwic3RhcnRzV2l0aCIsImZyYW1lcyIsImZyYW1lUGF0aCIsImZyYW1lRGF0YSIsInJlYWRGaWxlIiwiYmFzZTY0RGF0YSIsInRvU3RyaW5nIiwiZSIsImNvbnNvbGUiLCJ3YXJuIiwicHJvbXB0Iiwic3RhdHMiLCJnZXRTdGF0cyIsImluZGV4X3NpemUiLCJyZXN1bHRzIiwic2VhcmNoIiwiY29udGV4dHMiLCJtYXAiLCJjIiwiaSIsImNodW5rIiwidGV4dCIsImpvaW4iLCJoaXN0Iiwic2xpY2UiLCJtIiwiYW5zd2VyIiwicmVzcG9uc2UiLCJyZWxldmFudF9jaHVua3MiLCJjaHVua19jb3VudCIsIm1lZGlhX2FuYWx5emVkIiwiciIsImNodW5rX2luZm8iLCJzY29yZSIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/documentProcessor.ts":
/*!**********************************!*\
  !*** ./lib/documentProcessor.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   cleanText: () => (/* binding */ cleanText),\n/* harmony export */   extractTextFromPdf: () => (/* binding */ extractTextFromPdf),\n/* harmony export */   extractTextFromTxt: () => (/* binding */ extractTextFromTxt),\n/* harmony export */   extractVideoFrames: () => (/* binding */ extractVideoFrames),\n/* harmony export */   processDocument: () => (/* binding */ processDocument)\n/* harmony export */ });\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:fs/promises */ \"node:fs/promises\");\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pdf_parse__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pdf-parse */ \"pdf-parse\");\n/* harmony import */ var pdf_parse__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pdf_parse__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var mammoth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! mammoth */ \"mammoth\");\n/* harmony import */ var mammoth__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(mammoth__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var remove_markdown__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! remove-markdown */ \"(rsc)/./node_modules/remove-markdown/index.js\");\n/* harmony import */ var remove_markdown__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(remove_markdown__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jszip */ \"jszip\");\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jszip__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var tesseract_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! tesseract.js */ \"tesseract.js\");\n/* harmony import */ var tesseract_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(tesseract_js__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./settings */ \"(rsc)/./lib/settings.ts\");\n/* harmony import */ var ffmpeg_static__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ffmpeg-static */ \"ffmpeg-static\");\n/* harmony import */ var ffmpeg_static__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(ffmpeg_static__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var node_child_process__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! node:child_process */ \"node:child_process\");\n/* harmony import */ var node_child_process__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(node_child_process__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var node_util__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! node:util */ \"node:util\");\n/* harmony import */ var node_util__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(node_util__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var node_os__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! node:os */ \"node:os\");\n/* harmony import */ var node_os__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(node_os__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! node:path */ \"node:path\");\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(node_path__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var _xenova_transformers__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @xenova/transformers */ \"(rsc)/./node_modules/@xenova/transformers/src/transformers.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst execFile = (0,node_util__WEBPACK_IMPORTED_MODULE_9__.promisify)(node_child_process__WEBPACK_IMPORTED_MODULE_8__.execFile);\nasync function extractTextFromPdf(filePath) {\n    try {\n        const data = await node_fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(filePath);\n        const res = await pdf_parse__WEBPACK_IMPORTED_MODULE_1___default()(data);\n        return res.text || \"\";\n    } catch (e) {\n        throw new Error(`Error extracting text from PDF: ${e.message || e}`);\n    }\n}\nasync function extractTextFromTxt(filePath) {\n    try {\n        const content = await node_fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(filePath, {\n            encoding: \"utf-8\"\n        });\n        return content;\n    } catch (e) {\n        const content = await node_fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(filePath, {\n            encoding: \"latin1\"\n        });\n        return content;\n    }\n}\nfunction cleanText(text) {\n    return text.split(/\\s+/).join(\" \").trim();\n}\nasync function processDocument(filePath) {\n    const lower = filePath.toLowerCase();\n    let text = \"\";\n    if (lower.endsWith(\".pdf\")) {\n        text = await extractTextFromPdf(filePath);\n    } else if (lower.endsWith(\".txt\") || lower.endsWith(\".text\") || lower.endsWith(\".bxt\")) {\n        text = await extractTextFromTxt(filePath);\n    } else if (lower.endsWith(\".md\") || lower.endsWith(\".markdown\")) {\n        const raw = await extractTextFromTxt(filePath);\n        text = remove_markdown__WEBPACK_IMPORTED_MODULE_3___default()(raw);\n    } else if (lower.endsWith(\".docx\")) {\n        try {\n            const data = await node_fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(filePath);\n            const result = await mammoth__WEBPACK_IMPORTED_MODULE_2___default().extractRawText({\n                buffer: data\n            });\n            text = result.value || \"\";\n        } catch (e) {\n            throw new Error(`Error extracting text from DOCX: ${e.message || e}`);\n        }\n    } else if (lower.endsWith(\".pptx\")) {\n        try {\n            const data = await node_fs_promises__WEBPACK_IMPORTED_MODULE_0___default().readFile(filePath);\n            const zip = await jszip__WEBPACK_IMPORTED_MODULE_4___default().loadAsync(data);\n            const slideFiles = Object.keys(zip.files).filter((p)=>p.startsWith(\"ppt/slides/slide\") && p.endsWith(\".xml\"));\n            const contents = await Promise.all(slideFiles.map(async (p)=>{\n                const file = zip.file(p);\n                if (!file) return \"\";\n                const xml = await file.async(\"text\");\n                return xml.replace(/<[^>]+>/g, \" \").replace(/&amp;/g, \"&\").replace(/&lt;/g, \"<\").replace(/&gt;/g, \">\").replace(/&quot;/g, '\"').replace(/&#39;/g, \"'\");\n            }));\n            text = contents.join(\"\\n\");\n        } catch (e) {\n            throw new Error(`Error extracting text from PPTX: ${e.message || e}`);\n        }\n    } else {\n        if (lower.endsWith(\".png\") || lower.endsWith(\".jpg\") || lower.endsWith(\".jpeg\")) {\n            if (!_settings__WEBPACK_IMPORTED_MODULE_6__.settings.ENABLE_OCR) {\n                throw new Error(\"OCR is disabled by settings.\");\n            }\n            try {\n                const result = await tesseract_js__WEBPACK_IMPORTED_MODULE_5___default().recognize(filePath, \"eng\");\n                text = result.data.text || \"\";\n            } catch (e) {\n                throw new Error(`Error extracting text from image: ${e.message || e}`);\n            }\n        } else if (lower.endsWith(\".mp3\") || lower.endsWith(\".mp4\") || lower.endsWith(\".wav\") || lower.endsWith(\".m4a\")) {\n            const wavPath = await ensureWavMono16k(filePath);\n            const asr = await (0,_xenova_transformers__WEBPACK_IMPORTED_MODULE_12__.pipeline)(\"automatic-speech-recognition\", \"Xenova/whisper-tiny.en\");\n            const result = await asr(wavPath, {\n                chunk_length_s: 30\n            });\n            text = result?.text || \"\";\n        } else {\n            throw new Error(`Unsupported file type: ${filePath}`);\n        }\n    }\n    return cleanText(text);\n}\nasync function ensureWavMono16k(inputPath) {\n    if (!(ffmpeg_static__WEBPACK_IMPORTED_MODULE_7___default())) throw new Error(\"ffmpeg not available\");\n    const out = node_path__WEBPACK_IMPORTED_MODULE_11___default().join(node_os__WEBPACK_IMPORTED_MODULE_10___default().tmpdir(), `${Date.now()}_audio.wav`);\n    await execFile((ffmpeg_static__WEBPACK_IMPORTED_MODULE_7___default()), [\n        \"-y\",\n        \"-i\",\n        inputPath,\n        \"-ac\",\n        \"1\",\n        \"-ar\",\n        \"16000\",\n        \"-f\",\n        \"wav\",\n        out\n    ]);\n    return out;\n}\nasync function extractVideoFrames(videoPath, maxFrames = 5) {\n    if (!(ffmpeg_static__WEBPACK_IMPORTED_MODULE_7___default())) throw new Error(\"ffmpeg not available\");\n    const framePaths = [];\n    const baseTimestamp = Date.now();\n    // Extract frames at intervals (start, middle, end)\n    // Extract frames at: 0%, 25%, 50%, 75%, 100% of video (or maxFrames evenly spaced)\n    for(let i = 0; i < maxFrames; i++){\n        const framePath = node_path__WEBPACK_IMPORTED_MODULE_11___default().join(node_os__WEBPACK_IMPORTED_MODULE_10___default().tmpdir(), `${baseTimestamp}_frame_${i}.jpg`);\n        try {\n            // Use percentage-based extraction for better coverage\n            // -ss seeks to timestamp, then extract one frame\n            // We'll extract frames at regular intervals (every 10 seconds or evenly distributed)\n            const timestamp = i * 10; // Extract every 10 seconds\n            await execFile((ffmpeg_static__WEBPACK_IMPORTED_MODULE_7___default()), [\n                \"-y\",\n                \"-ss\",\n                timestamp.toString(),\n                \"-i\",\n                videoPath,\n                \"-vframes\",\n                \"1\",\n                \"-q:v\",\n                \"2\",\n                \"-vf\",\n                \"scale=800:-1\",\n                framePath\n            ], {\n                timeout: 15000\n            });\n            // Check if frame file was created and has content\n            try {\n                const stats = await node_fs_promises__WEBPACK_IMPORTED_MODULE_0___default().stat(framePath);\n                if (stats.size > 0) {\n                    framePaths.push(framePath);\n                }\n            } catch  {\n            // Frame not created or empty, skip\n            }\n        } catch (e) {\n            console.warn(`Failed to extract frame ${i} at ${i * 10}s:`, e);\n        // Continue with next frame\n        }\n    }\n    return framePaths;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SSxNQUFNRSxJQUFJLEdBQUcsR0FBRztvQkFDbEJULFdBQVdVLElBQUksQ0FBQ1A7Z0JBQ2xCO1lBQ0YsRUFBRSxPQUFNO1lBQ04sbUNBQW1DO1lBQ3JDO1FBQ0YsRUFBRSxPQUFPckQsR0FBRztZQUNWNkQsUUFBUUMsSUFBSSxDQUFDLENBQUMsd0JBQXdCLEVBQUVWLEVBQUUsSUFBSSxFQUFFQSxJQUFJLEdBQUcsRUFBRSxDQUFDLEVBQUVwRDtRQUM1RCwyQkFBMkI7UUFDN0I7SUFDRjtJQUVBLE9BQU9rRDtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZG9jcy1jaGF0LW5leHQvLi9saWIvZG9jdW1lbnRQcm9jZXNzb3IudHM/ZTQyNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSBcIm5vZGU6ZnMvcHJvbWlzZXNcIjtcclxuaW1wb3J0IHBkZiBmcm9tIFwicGRmLXBhcnNlXCI7XHJcbmltcG9ydCBtYW1tb3RoIGZyb20gXCJtYW1tb3RoXCI7XHJcbmltcG9ydCByZW1vdmVNYXJrZG93biBmcm9tIFwicmVtb3ZlLW1hcmtkb3duXCI7XHJcbmltcG9ydCBKU1ppcCBmcm9tIFwianN6aXBcIjtcclxuaW1wb3J0IFRlc3NlcmFjdCBmcm9tIFwidGVzc2VyYWN0LmpzXCI7XHJcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcclxuaW1wb3J0IGZmbXBlZ1BhdGggZnJvbSBcImZmbXBlZy1zdGF0aWNcIjtcclxuaW1wb3J0IHsgZXhlY0ZpbGUgYXMgZXhlY0ZpbGVDYiB9IGZyb20gXCJub2RlOmNoaWxkX3Byb2Nlc3NcIjtcclxuaW1wb3J0IHsgcHJvbWlzaWZ5IH0gZnJvbSBcIm5vZGU6dXRpbFwiO1xyXG5pbXBvcnQgb3MgZnJvbSBcIm5vZGU6b3NcIjtcclxuaW1wb3J0IHBhdGggZnJvbSBcIm5vZGU6cGF0aFwiO1xyXG5pbXBvcnQgeyBwaXBlbGluZSBhcyBoZlBpcGVsaW5lIH0gZnJvbSBcIkB4ZW5vdmEvdHJhbnNmb3JtZXJzXCI7XHJcblxyXG5jb25zdCBleGVjRmlsZSA9IHByb21pc2lmeShleGVjRmlsZUNiKTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleHRyYWN0VGV4dEZyb21QZGYoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmcy5yZWFkRmlsZShmaWxlUGF0aCk7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwZGYoZGF0YSk7XHJcbiAgICByZXR1cm4gcmVzLnRleHQgfHwgXCJcIjtcclxuICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgZXh0cmFjdGluZyB0ZXh0IGZyb20gUERGOiAke2UubWVzc2FnZSB8fCBlfWApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4dHJhY3RUZXh0RnJvbVR4dChmaWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgY29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKGZpbGVQYXRoLCB7IGVuY29kaW5nOiBcInV0Zi04XCIgfSk7XHJcbiAgICByZXR1cm4gY29udGVudDtcclxuICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBmcy5yZWFkRmlsZShmaWxlUGF0aCwgeyBlbmNvZGluZzogXCJsYXRpbjFcIiB9KTtcclxuICAgIHJldHVybiBjb250ZW50O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFuVGV4dCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHJldHVybiB0ZXh0LnNwbGl0KC9cXHMrLykuam9pbihcIiBcIikudHJpbSgpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0RvY3VtZW50KGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIGNvbnN0IGxvd2VyID0gZmlsZVBhdGgudG9Mb3dlckNhc2UoKTtcclxuICBsZXQgdGV4dCA9IFwiXCI7XHJcbiAgaWYgKGxvd2VyLmVuZHNXaXRoKCcucGRmJykpIHtcclxuICAgIHRleHQgPSBhd2FpdCBleHRyYWN0VGV4dEZyb21QZGYoZmlsZVBhdGgpO1xyXG4gIH0gZWxzZSBpZiAobG93ZXIuZW5kc1dpdGgoJy50eHQnKSB8fCBsb3dlci5lbmRzV2l0aCgnLnRleHQnKSB8fCBsb3dlci5lbmRzV2l0aCgnLmJ4dCcpKSB7XHJcbiAgICB0ZXh0ID0gYXdhaXQgZXh0cmFjdFRleHRGcm9tVHh0KGZpbGVQYXRoKTtcclxuICB9IGVsc2UgaWYgKGxvd2VyLmVuZHNXaXRoKCcubWQnKSB8fCBsb3dlci5lbmRzV2l0aCgnLm1hcmtkb3duJykpIHtcclxuICAgIGNvbnN0IHJhdyA9IGF3YWl0IGV4dHJhY3RUZXh0RnJvbVR4dChmaWxlUGF0aCk7XHJcbiAgICB0ZXh0ID0gcmVtb3ZlTWFya2Rvd24ocmF3KTtcclxuICB9IGVsc2UgaWYgKGxvd2VyLmVuZHNXaXRoKCcuZG9jeCcpKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgZnMucmVhZEZpbGUoZmlsZVBhdGgpO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtYW1tb3RoLmV4dHJhY3RSYXdUZXh0KHsgYnVmZmVyOiBkYXRhIH0pO1xyXG4gICAgICB0ZXh0ID0gcmVzdWx0LnZhbHVlIHx8IFwiXCI7XHJcbiAgICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBleHRyYWN0aW5nIHRleHQgZnJvbSBET0NYOiAke2UubWVzc2FnZSB8fCBlfWApO1xyXG4gICAgfVxyXG4gIH0gZWxzZSBpZiAobG93ZXIuZW5kc1dpdGgoJy5wcHR4JykpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmcy5yZWFkRmlsZShmaWxlUGF0aCk7XHJcbiAgICAgIGNvbnN0IHppcCA9IGF3YWl0IEpTWmlwLmxvYWRBc3luYyhkYXRhKTtcclxuICAgICAgY29uc3Qgc2xpZGVGaWxlcyA9IE9iamVjdC5rZXlzKHppcC5maWxlcykuZmlsdGVyKChwKSA9PiBwLnN0YXJ0c1dpdGgoJ3BwdC9zbGlkZXMvc2xpZGUnKSAmJiBwLmVuZHNXaXRoKCcueG1sJykpO1xyXG4gICAgICBjb25zdCBjb250ZW50cyA9IGF3YWl0IFByb21pc2UuYWxsKHNsaWRlRmlsZXMubWFwKGFzeW5jIChwKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZmlsZSA9IHppcC5maWxlKHApO1xyXG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIFwiXCI7XHJcbiAgICAgICAgY29uc3QgeG1sID0gYXdhaXQgZmlsZS5hc3luYygndGV4dCcpO1xyXG4gICAgICAgIHJldHVybiB4bWwucmVwbGFjZSgvPFtePl0rPi9nLCAnICcpLnJlcGxhY2UoLyZhbXA7L2csICcmJykucmVwbGFjZSgvJmx0Oy9nLCAnPCcpLnJlcGxhY2UoLyZndDsvZywgJz4nKS5yZXBsYWNlKC8mcXVvdDsvZywgJ1wiJykucmVwbGFjZSgvJiMzOTsvZywgXCInXCIpO1xyXG4gICAgICB9KSk7XHJcbiAgICAgIHRleHQgPSBjb250ZW50cy5qb2luKCdcXG4nKTtcclxuICAgIH0gY2F0Y2ggKGU6IGFueSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGV4dHJhY3RpbmcgdGV4dCBmcm9tIFBQVFg6ICR7ZS5tZXNzYWdlIHx8IGV9YCk7XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIGlmIChsb3dlci5lbmRzV2l0aCgnLnBuZycpIHx8IGxvd2VyLmVuZHNXaXRoKCcuanBnJykgfHwgbG93ZXIuZW5kc1dpdGgoJy5qcGVnJykpIHtcclxuICAgICAgaWYgKCFzZXR0aW5ncy5FTkFCTEVfT0NSKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT0NSIGlzIGRpc2FibGVkIGJ5IHNldHRpbmdzLlwiKTtcclxuICAgICAgfVxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFRlc3NlcmFjdC5yZWNvZ25pemUoZmlsZVBhdGgsICdlbmcnKTtcclxuICAgICAgICB0ZXh0ID0gcmVzdWx0LmRhdGEudGV4dCB8fCBcIlwiO1xyXG4gICAgICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGV4dHJhY3RpbmcgdGV4dCBmcm9tIGltYWdlOiAke2UubWVzc2FnZSB8fCBlfWApO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGxvd2VyLmVuZHNXaXRoKCcubXAzJykgfHwgbG93ZXIuZW5kc1dpdGgoJy5tcDQnKSB8fCBsb3dlci5lbmRzV2l0aCgnLndhdicpIHx8IGxvd2VyLmVuZHNXaXRoKCcubTRhJykpIHtcclxuICAgICAgY29uc3Qgd2F2UGF0aCA9IGF3YWl0IGVuc3VyZVdhdk1vbm8xNmsoZmlsZVBhdGgpO1xyXG4gICAgICBjb25zdCBhc3IgPSBhd2FpdCBoZlBpcGVsaW5lKCdhdXRvbWF0aWMtc3BlZWNoLXJlY29nbml0aW9uJywgJ1hlbm92YS93aGlzcGVyLXRpbnkuZW4nKTtcclxuICAgICAgY29uc3QgcmVzdWx0OiBhbnkgPSBhd2FpdCBhc3Iod2F2UGF0aCwgeyBjaHVua19sZW5ndGhfczogMzAgfSk7XHJcbiAgICAgIHRleHQgPSByZXN1bHQ/LnRleHQgfHwgJyc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBmaWxlIHR5cGU6ICR7ZmlsZVBhdGh9YCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiBjbGVhblRleHQodGV4dCk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGVuc3VyZVdhdk1vbm8xNmsoaW5wdXRQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIGlmICghZmZtcGVnUGF0aCkgdGhyb3cgbmV3IEVycm9yKCdmZm1wZWcgbm90IGF2YWlsYWJsZScpO1xyXG4gIGNvbnN0IG91dCA9IHBhdGguam9pbihvcy50bXBkaXIoKSwgYCR7RGF0ZS5ub3coKX1fYXVkaW8ud2F2YCk7XHJcbiAgYXdhaXQgZXhlY0ZpbGUoZmZtcGVnUGF0aCBhcyBzdHJpbmcsIFtcclxuICAgICcteScsXHJcbiAgICAnLWknLCBpbnB1dFBhdGgsXHJcbiAgICAnLWFjJywgJzEnLFxyXG4gICAgJy1hcicsICcxNjAwMCcsXHJcbiAgICAnLWYnLCAnd2F2JyxcclxuICAgIG91dCxcclxuICBdKTtcclxuICByZXR1cm4gb3V0O1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXh0cmFjdFZpZGVvRnJhbWVzKHZpZGVvUGF0aDogc3RyaW5nLCBtYXhGcmFtZXM6IG51bWJlciA9IDUpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgaWYgKCFmZm1wZWdQYXRoKSB0aHJvdyBuZXcgRXJyb3IoJ2ZmbXBlZyBub3QgYXZhaWxhYmxlJyk7XHJcbiAgXHJcbiAgY29uc3QgZnJhbWVQYXRoczogc3RyaW5nW10gPSBbXTtcclxuICBjb25zdCBiYXNlVGltZXN0YW1wID0gRGF0ZS5ub3coKTtcclxuICBcclxuICAvLyBFeHRyYWN0IGZyYW1lcyBhdCBpbnRlcnZhbHMgKHN0YXJ0LCBtaWRkbGUsIGVuZClcclxuICAvLyBFeHRyYWN0IGZyYW1lcyBhdDogMCUsIDI1JSwgNTAlLCA3NSUsIDEwMCUgb2YgdmlkZW8gKG9yIG1heEZyYW1lcyBldmVubHkgc3BhY2VkKVxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbWF4RnJhbWVzOyBpKyspIHtcclxuICAgIGNvbnN0IGZyYW1lUGF0aCA9IHBhdGguam9pbihvcy50bXBkaXIoKSwgYCR7YmFzZVRpbWVzdGFtcH1fZnJhbWVfJHtpfS5qcGdgKTtcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gVXNlIHBlcmNlbnRhZ2UtYmFzZWQgZXh0cmFjdGlvbiBmb3IgYmV0dGVyIGNvdmVyYWdlXHJcbiAgICAgIC8vIC1zcyBzZWVrcyB0byB0aW1lc3RhbXAsIHRoZW4gZXh0cmFjdCBvbmUgZnJhbWVcclxuICAgICAgLy8gV2UnbGwgZXh0cmFjdCBmcmFtZXMgYXQgcmVndWxhciBpbnRlcnZhbHMgKGV2ZXJ5IDEwIHNlY29uZHMgb3IgZXZlbmx5IGRpc3RyaWJ1dGVkKVxyXG4gICAgICBjb25zdCB0aW1lc3RhbXAgPSBpICogMTA7IC8vIEV4dHJhY3QgZXZlcnkgMTAgc2Vjb25kc1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgZXhlY0ZpbGUoZmZtcGVnUGF0aCBhcyBzdHJpbmcsIFtcclxuICAgICAgICAnLXknLFxyXG4gICAgICAgICctc3MnLCB0aW1lc3RhbXAudG9TdHJpbmcoKSxcclxuICAgICAgICAnLWknLCB2aWRlb1BhdGgsXHJcbiAgICAgICAgJy12ZnJhbWVzJywgJzEnLFxyXG4gICAgICAgICctcTp2JywgJzInLCAvLyBIaWdoIHF1YWxpdHlcclxuICAgICAgICAnLXZmJywgJ3NjYWxlPTgwMDotMScsIC8vIFJlc2l6ZSBmb3IgZWZmaWNpZW5jeVxyXG4gICAgICAgIGZyYW1lUGF0aCxcclxuICAgICAgXSwgeyB0aW1lb3V0OiAxNTAwMCB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIENoZWNrIGlmIGZyYW1lIGZpbGUgd2FzIGNyZWF0ZWQgYW5kIGhhcyBjb250ZW50XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3Qgc3RhdHMgPSBhd2FpdCBmcy5zdGF0KGZyYW1lUGF0aCk7XHJcbiAgICAgICAgaWYgKHN0YXRzLnNpemUgPiAwKSB7XHJcbiAgICAgICAgICBmcmFtZVBhdGhzLnB1c2goZnJhbWVQYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgIC8vIEZyYW1lIG5vdCBjcmVhdGVkIG9yIGVtcHR5LCBza2lwXHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gZXh0cmFjdCBmcmFtZSAke2l9IGF0ICR7aSAqIDEwfXM6YCwgZSk7XHJcbiAgICAgIC8vIENvbnRpbnVlIHdpdGggbmV4dCBmcmFtZVxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICByZXR1cm4gZnJhbWVQYXRocztcclxufVxyXG5cclxuIl0sIm5hbWVzIjpbImZzIiwicGRmIiwibWFtbW90aCIsInJlbW92ZU1hcmtkb3duIiwiSlNaaXAiLCJUZXNzZXJhY3QiLCJzZXR0aW5ncyIsImZmbXBlZ1BhdGgiLCJleGVjRmlsZSIsImV4ZWNGaWxlQ2IiLCJwcm9taXNpZnkiLCJvcyIsInBhdGgiLCJwaXBlbGluZSIsImhmUGlwZWxpbmUiLCJleHRyYWN0VGV4dEZyb21QZGYiLCJmaWxlUGF0aCIsImRhdGEiLCJyZWFkRmlsZSIsInJlcyIsInRleHQiLCJlIiwiRXJyb3IiLCJtZXNzYWdlIiwiZXh0cmFjdFRleHRGcm9tVHh0IiwiY29udGVudCIsImVuY29kaW5nIiwiY2xlYW5UZXh0Iiwic3BsaXQiLCJqb2luIiwidHJpbSIsInByb2Nlc3NEb2N1bWVudCIsImxvd2VyIiwidG9Mb3dlckNhc2UiLCJlbmRzV2l0aCIsInJhdyIsInJlc3VsdCIsImV4dHJhY3RSYXdUZXh0IiwiYnVmZmVyIiwidmFsdWUiLCJ6aXAiLCJsb2FkQXN5bmMiLCJzbGlkZUZpbGVzIiwiT2JqZWN0Iiwia2V5cyIsImZpbGVzIiwiZmlsdGVyIiwicCIsInN0YXJ0c1dpdGgiLCJjb250ZW50cyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJmaWxlIiwieG1sIiwiYXN5bmMiLCJyZXBsYWNlIiwiRU5BQkxFX09DUiIsInJlY29nbml6ZSIsIndhdlBhdGgiLCJlbnN1cmVXYXZNb25vMTZrIiwiYXNyIiwiY2h1bmtfbGVuZ3RoX3MiLCJpbnB1dFBhdGgiLCJvdXQiLCJ0bXBkaXIiLCJEYXRlIiwibm93IiwiZXh0cmFjdFZpZGVvRnJhbWVzIiwidmlkZW9QYXRoIiwibWF4RnJhbWVzIiwiZnJhbWVQYXRocyIsImJhc2VUaW1lc3RhbXAiLCJpIiwiZnJhbWVQYXRoIiwidGltZXN0YW1wIiwidG9TdHJpbmciLCJ0aW1lb3V0Iiwic3RhdHMiLCJzdGF0Iiwic2l6ZSIsInB1c2giLCJjb25zb2xlIiwid2FybiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/documentProcessor.ts\n");

/***/ }),

/***/ "(rsc)/./lib/gemini.ts":
/*!***********************!*\
  !*** ./lib/gemini.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   buildRagPrompt: () => (/* binding */ buildRagPrompt),\n/* harmony export */   generateWithGemini: () => (/* binding */ generateWithGemini),\n/* harmony export */   getMimeType: () => (/* binding */ getMimeType)\n/* harmony export */ });\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\n/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./settings */ \"(rsc)/./lib/settings.ts\");\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! node:fs/promises */ \"node:fs/promises\");\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(node_fs_promises__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nfunction buildRagPrompt(query, relevant, history) {\n    const contexts = relevant.map((c, i)=>`[Context ${i + 1}]:\\n${c.text || \"\"}\\n`).join(\"\\n\");\n    const hist = (history || []).slice(-5).map((m)=>`${capitalize(m.role)}: ${m.content}`).join(\"\\n\");\n    return `${_settings__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_PROMPT}\r\n\r\nDOCUMENT CONTEXT:\r\n${contexts}\r\n\r\n${hist ? `CONVERSATION HISTORY:\\n${hist}\\n\\n` : \"\"}USER QUESTION:\r\n${query}\r\n\r\nANSWER:`;\n}\nasync function generateWithGemini(prompt, mediaFiles) {\n    if (!_settings__WEBPACK_IMPORTED_MODULE_1__.settings.GEMINI_API_KEY) {\n        throw new Error(\"GEMINI_API_KEY not set\");\n    }\n    const genai = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAI(_settings__WEBPACK_IMPORTED_MODULE_1__.settings.GEMINI_API_KEY);\n    const model = genai.getGenerativeModel({\n        model: _settings__WEBPACK_IMPORTED_MODULE_1__.settings.GEMINI_MODEL\n    });\n    // Build parts array: text + media files\n    const parts = [\n        {\n            text: prompt\n        }\n    ];\n    // Add media files (images/videos) to the prompt\n    if (mediaFiles && mediaFiles.length > 0) {\n        for (const media of mediaFiles){\n            try {\n                const fileData = await node_fs_promises__WEBPACK_IMPORTED_MODULE_2___default().readFile(media.filePath);\n                const base64Data = fileData.toString(\"base64\");\n                parts.push({\n                    inline_data: {\n                        mime_type: media.mimeType,\n                        data: base64Data\n                    }\n                });\n            } catch (e) {\n                console.warn(`Failed to read media file ${media.filePath}:`, e);\n            }\n        }\n    }\n    const result = await model.generateContent({\n        contents: [\n            {\n                role: \"user\",\n                parts\n            }\n        ]\n    });\n    const text = result.response.text();\n    return text;\n}\nfunction capitalize(s) {\n    return s ? s[0].toUpperCase() + s.slice(1) : s;\n}\nfunction getMimeType(filePath) {\n    const lower = filePath.toLowerCase();\n    if (lower.endsWith(\".png\")) return \"image/png\";\n    if (lower.endsWith(\".jpg\") || lower.endsWith(\".jpeg\")) return \"image/jpeg\";\n    if (lower.endsWith(\".gif\")) return \"image/gif\";\n    if (lower.endsWith(\".webp\")) return \"image/webp\";\n    if (lower.endsWith(\".mp4\")) return \"video/mp4\";\n    if (lower.endsWith(\".webm\")) return \"video/webm\";\n    if (lower.endsWith(\".mov\")) return \"video/quicktime\";\n    return \"application/octet-stream\";\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3BDLElBQUlGLE1BQU1FLFFBQVEsQ0FBQyxTQUFTLE9BQU87SUFDbkMsT0FBTztBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZG9jcy1jaGF0LW5leHQvLi9saWIvZ2VtaW5pLnRzP2I2MzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR29vZ2xlR2VuZXJhdGl2ZUFJIH0gZnJvbSBcIkBnb29nbGUvZ2VuZXJhdGl2ZS1haVwiO1xyXG5pbXBvcnQgeyBTWVNURU1fUFJPTVBULCBzZXR0aW5ncyB9IGZyb20gXCIuL3NldHRpbmdzXCI7XHJcbmltcG9ydCBmcyBmcm9tIFwibm9kZTpmcy9wcm9taXNlc1wiO1xyXG5pbXBvcnQgcGF0aCBmcm9tIFwibm9kZTpwYXRoXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRSYWdQcm9tcHQocXVlcnk6IHN0cmluZywgcmVsZXZhbnQ6IHsgdGV4dD86IHN0cmluZyB9W10sIGhpc3Rvcnk/OiB7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIH1bXSkge1xyXG4gIGNvbnN0IGNvbnRleHRzID0gcmVsZXZhbnQubWFwKChjLCBpKSA9PiBgW0NvbnRleHQgJHtpICsgMX1dOlxcbiR7Yy50ZXh0IHx8IFwiXCJ9XFxuYCkuam9pbihcIlxcblwiKTtcclxuICBjb25zdCBoaXN0ID0gKGhpc3RvcnkgfHwgW10pLnNsaWNlKC01KS5tYXAobSA9PiBgJHtjYXBpdGFsaXplKG0ucm9sZSl9OiAke20uY29udGVudH1gKS5qb2luKFwiXFxuXCIpO1xyXG4gIHJldHVybiBgJHtTWVNURU1fUFJPTVBUfVxyXG5cclxuRE9DVU1FTlQgQ09OVEVYVDpcclxuJHtjb250ZXh0c31cclxuXHJcbiR7aGlzdCA/IGBDT05WRVJTQVRJT04gSElTVE9SWTpcXG4ke2hpc3R9XFxuXFxuYCA6IFwiXCJ9VVNFUiBRVUVTVElPTjpcclxuJHtxdWVyeX1cclxuXHJcbkFOU1dFUjpgO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVXaXRoR2VtaW5pKFxyXG4gIHByb21wdDogc3RyaW5nLCBcclxuICBtZWRpYUZpbGVzPzogeyBmaWxlUGF0aDogc3RyaW5nOyBtaW1lVHlwZTogc3RyaW5nIH1bXVxyXG4pOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIGlmICghc2V0dGluZ3MuR0VNSU5JX0FQSV9LRVkpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkdFTUlOSV9BUElfS0VZIG5vdCBzZXRcIik7XHJcbiAgfVxyXG4gIGNvbnN0IGdlbmFpID0gbmV3IEdvb2dsZUdlbmVyYXRpdmVBSShzZXR0aW5ncy5HRU1JTklfQVBJX0tFWSk7XHJcbiAgY29uc3QgbW9kZWwgPSBnZW5haS5nZXRHZW5lcmF0aXZlTW9kZWwoeyBtb2RlbDogc2V0dGluZ3MuR0VNSU5JX01PREVMIH0pO1xyXG4gIFxyXG4gIC8vIEJ1aWxkIHBhcnRzIGFycmF5OiB0ZXh0ICsgbWVkaWEgZmlsZXNcclxuICBjb25zdCBwYXJ0czogYW55W10gPSBbeyB0ZXh0OiBwcm9tcHQgfV07XHJcbiAgXHJcbiAgLy8gQWRkIG1lZGlhIGZpbGVzIChpbWFnZXMvdmlkZW9zKSB0byB0aGUgcHJvbXB0XHJcbiAgaWYgKG1lZGlhRmlsZXMgJiYgbWVkaWFGaWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICBmb3IgKGNvbnN0IG1lZGlhIG9mIG1lZGlhRmlsZXMpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBmaWxlRGF0YSA9IGF3YWl0IGZzLnJlYWRGaWxlKG1lZGlhLmZpbGVQYXRoKTtcclxuICAgICAgICBjb25zdCBiYXNlNjREYXRhID0gZmlsZURhdGEudG9TdHJpbmcoJ2Jhc2U2NCcpO1xyXG4gICAgICAgIHBhcnRzLnB1c2goe1xyXG4gICAgICAgICAgaW5saW5lX2RhdGE6IHtcclxuICAgICAgICAgICAgbWltZV90eXBlOiBtZWRpYS5taW1lVHlwZSxcclxuICAgICAgICAgICAgZGF0YTogYmFzZTY0RGF0YVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gcmVhZCBtZWRpYSBmaWxlICR7bWVkaWEuZmlsZVBhdGh9OmAsIGUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG1vZGVsLmdlbmVyYXRlQ29udGVudCh7IFxyXG4gICAgY29udGVudHM6IFt7IHJvbGU6IFwidXNlclwiLCBwYXJ0cyB9XSBcclxuICB9KTtcclxuICBjb25zdCB0ZXh0ID0gcmVzdWx0LnJlc3BvbnNlLnRleHQoKTtcclxuICByZXR1cm4gdGV4dDtcclxufVxyXG5cclxuZnVuY3Rpb24gY2FwaXRhbGl6ZShzOiBzdHJpbmcpIHtcclxuICByZXR1cm4gcyA/IHNbMF0udG9VcHBlckNhc2UoKSArIHMuc2xpY2UoMSkgOiBzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWltZVR5cGUoZmlsZVBhdGg6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgbG93ZXIgPSBmaWxlUGF0aC50b0xvd2VyQ2FzZSgpO1xyXG4gIGlmIChsb3dlci5lbmRzV2l0aCgnLnBuZycpKSByZXR1cm4gJ2ltYWdlL3BuZyc7XHJcbiAgaWYgKGxvd2VyLmVuZHNXaXRoKCcuanBnJykgfHwgbG93ZXIuZW5kc1dpdGgoJy5qcGVnJykpIHJldHVybiAnaW1hZ2UvanBlZyc7XHJcbiAgaWYgKGxvd2VyLmVuZHNXaXRoKCcuZ2lmJykpIHJldHVybiAnaW1hZ2UvZ2lmJztcclxuICBpZiAobG93ZXIuZW5kc1dpdGgoJy53ZWJwJykpIHJldHVybiAnaW1hZ2Uvd2VicCc7XHJcbiAgaWYgKGxvd2VyLmVuZHNXaXRoKCcubXA0JykpIHJldHVybiAndmlkZW8vbXA0JztcclxuICBpZiAobG93ZXIuZW5kc1dpdGgoJy53ZWJtJykpIHJldHVybiAndmlkZW8vd2VibSc7XHJcbiAgaWYgKGxvd2VyLmVuZHNXaXRoKCcubW92JykpIHJldHVybiAndmlkZW8vcXVpY2t0aW1lJztcclxuICByZXR1cm4gJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSc7XHJcbn1cclxuXHJcbiJdLCJuYW1lcyI6WyJHb29nbGVHZW5lcmF0aXZlQUkiLCJTWVNURU1fUFJPTVBUIiwic2V0dGluZ3MiLCJmcyIsImJ1aWxkUmFnUHJvbXB0IiwicXVlcnkiLCJyZWxldmFudCIsImhpc3RvcnkiLCJjb250ZXh0cyIsIm1hcCIsImMiLCJpIiwidGV4dCIsImpvaW4iLCJoaXN0Iiwic2xpY2UiLCJtIiwiY2FwaXRhbGl6ZSIsInJvbGUiLCJjb250ZW50IiwiZ2VuZXJhdGVXaXRoR2VtaW5pIiwicHJvbXB0IiwibWVkaWFGaWxlcyIsIkdFTUlOSV9BUElfS0VZIiwiRXJyb3IiLCJnZW5haSIsIm1vZGVsIiwiZ2V0R2VuZXJhdGl2ZU1vZGVsIiwiR0VNSU5JX01PREVMIiwicGFydHMiLCJsZW5ndGgiLCJtZWRpYSIsImZpbGVEYXRhIiwicmVhZEZpbGUiLCJmaWxlUGF0aCIsImJhc2U2NERhdGEiLCJ0b1N0cmluZyIsInB1c2giLCJpbmxpbmVfZGF0YSIsIm1pbWVfdHlwZSIsIm1pbWVUeXBlIiwiZGF0YSIsImUiLCJjb25zb2xlIiwid2FybiIsInJlc3VsdCIsImdlbmVyYXRlQ29udGVudCIsImNvbnRlbnRzIiwicmVzcG9uc2UiLCJzIiwidG9VcHBlckNhc2UiLCJnZXRNaW1lVHlwZSIsImxvd2VyIiwidG9Mb3dlckNhc2UiLCJlbmRzV2l0aCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/gemini.ts\n");

/***/ }),

/***/ "(rsc)/./lib/settings.ts":
/*!*************************!*\
  !*** ./lib/settings.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SYSTEM_PROMPT: () => (/* binding */ SYSTEM_PROMPT),\n/* harmony export */   settings: () => (/* binding */ settings)\n/* harmony export */ });\nconst settings = {\n    GEMINI_API_KEY: process.env.GEMINI_API_KEY || \"\",\n    MAX_CHUNK_SIZE: Number(process.env.MAX_CHUNK_SIZE || 1000),\n    CHUNK_OVERLAP: Number(process.env.CHUNK_OVERLAP || 200),\n    MAX_FILE_SIZE_MB: Number(process.env.MAX_FILE_SIZE_MB || 50),\n    EMBEDDING_MODEL: process.env.EMBEDDING_MODEL || \"Xenova/all-MiniLM-L6-v2\",\n    GEMINI_MODEL: process.env.GEMINI_MODEL || \"gemini-2.0-flash-exp\",\n    TEMPERATURE: Number(process.env.TEMPERATURE || 0.7),\n    MAX_OUTPUT_TOKENS: Number(process.env.MAX_OUTPUT_TOKENS || 2048),\n    ENABLE_OCR: String(process.env.ENABLE_OCR || \"true\") === \"true\",\n    ENABLE_YOUTUBE: String(process.env.ENABLE_YOUTUBE || \"true\") === \"true\"\n};\nconst SYSTEM_PROMPT = `You are a helpful assistant that answers questions based ONLY on the provided document context.\r\nIf the answer cannot be found in the provided context, clearly state that the information is not available in the document.\r\nDo not make up information or use external knowledge. Always cite which part of the document you're referencing.`;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2V0dGluZ3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFhTyxNQUFNQSxXQUFxQjtJQUNoQ0MsZ0JBQWdCQyxRQUFRQyxHQUFHLENBQUNGLGNBQWMsSUFBSTtJQUM5Q0csZ0JBQWdCQyxPQUFPSCxRQUFRQyxHQUFHLENBQUNDLGNBQWMsSUFBSTtJQUNyREUsZUFBZUQsT0FBT0gsUUFBUUMsR0FBRyxDQUFDRyxhQUFhLElBQUk7SUFDbkRDLGtCQUFrQkYsT0FBT0gsUUFBUUMsR0FBRyxDQUFDSSxnQkFBZ0IsSUFBSTtJQUN6REMsaUJBQWlCTixRQUFRQyxHQUFHLENBQUNLLGVBQWUsSUFBSTtJQUNoREMsY0FBY1AsUUFBUUMsR0FBRyxDQUFDTSxZQUFZLElBQUk7SUFDMUNDLGFBQWFMLE9BQU9ILFFBQVFDLEdBQUcsQ0FBQ08sV0FBVyxJQUFJO0lBQy9DQyxtQkFBbUJOLE9BQU9ILFFBQVFDLEdBQUcsQ0FBQ1EsaUJBQWlCLElBQUk7SUFDM0RDLFlBQVlDLE9BQU9YLFFBQVFDLEdBQUcsQ0FBQ1MsVUFBVSxJQUFJLFlBQVk7SUFDekRFLGdCQUFnQkQsT0FBT1gsUUFBUUMsR0FBRyxDQUFDVyxjQUFjLElBQUksWUFBWTtBQUNuRSxFQUFFO0FBRUssTUFBTUMsZ0JBQWdCLENBQUM7O2dIQUVrRixDQUFDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kb2NzLWNoYXQtbmV4dC8uL2xpYi9zZXR0aW5ncy50cz8xZDcyIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB0eXBlIFNldHRpbmdzID0ge1xyXG4gIEdFTUlOSV9BUElfS0VZOiBzdHJpbmc7XHJcbiAgTUFYX0NIVU5LX1NJWkU6IG51bWJlcjtcclxuICBDSFVOS19PVkVSTEFQOiBudW1iZXI7XHJcbiAgTUFYX0ZJTEVfU0laRV9NQjogbnVtYmVyO1xyXG4gIEVNQkVERElOR19NT0RFTDogc3RyaW5nO1xyXG4gIEdFTUlOSV9NT0RFTDogc3RyaW5nO1xyXG4gIFRFTVBFUkFUVVJFOiBudW1iZXI7XHJcbiAgTUFYX09VVFBVVF9UT0tFTlM6IG51bWJlcjtcclxuICBFTkFCTEVfT0NSOiBib29sZWFuO1xyXG4gIEVOQUJMRV9ZT1VUVUJFOiBib29sZWFuO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHNldHRpbmdzOiBTZXR0aW5ncyA9IHtcclxuICBHRU1JTklfQVBJX0tFWTogcHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVkgfHwgXCJcIixcclxuICBNQVhfQ0hVTktfU0laRTogTnVtYmVyKHByb2Nlc3MuZW52Lk1BWF9DSFVOS19TSVpFIHx8IDEwMDApLFxyXG4gIENIVU5LX09WRVJMQVA6IE51bWJlcihwcm9jZXNzLmVudi5DSFVOS19PVkVSTEFQIHx8IDIwMCksXHJcbiAgTUFYX0ZJTEVfU0laRV9NQjogTnVtYmVyKHByb2Nlc3MuZW52Lk1BWF9GSUxFX1NJWkVfTUIgfHwgNTApLFxyXG4gIEVNQkVERElOR19NT0RFTDogcHJvY2Vzcy5lbnYuRU1CRURESU5HX01PREVMIHx8IFwiWGVub3ZhL2FsbC1NaW5pTE0tTDYtdjJcIixcclxuICBHRU1JTklfTU9ERUw6IHByb2Nlc3MuZW52LkdFTUlOSV9NT0RFTCB8fCBcImdlbWluaS0yLjAtZmxhc2gtZXhwXCIsXHJcbiAgVEVNUEVSQVRVUkU6IE51bWJlcihwcm9jZXNzLmVudi5URU1QRVJBVFVSRSB8fCAwLjcpLFxyXG4gIE1BWF9PVVRQVVRfVE9LRU5TOiBOdW1iZXIocHJvY2Vzcy5lbnYuTUFYX09VVFBVVF9UT0tFTlMgfHwgMjA0OCksXHJcbiAgRU5BQkxFX09DUjogU3RyaW5nKHByb2Nlc3MuZW52LkVOQUJMRV9PQ1IgfHwgXCJ0cnVlXCIpID09PSBcInRydWVcIixcclxuICBFTkFCTEVfWU9VVFVCRTogU3RyaW5nKHByb2Nlc3MuZW52LkVOQUJMRV9ZT1VUVUJFIHx8IFwidHJ1ZVwiKSA9PT0gXCJ0cnVlXCIsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgU1lTVEVNX1BST01QVCA9IGBZb3UgYXJlIGEgaGVscGZ1bCBhc3Npc3RhbnQgdGhhdCBhbnN3ZXJzIHF1ZXN0aW9ucyBiYXNlZCBPTkxZIG9uIHRoZSBwcm92aWRlZCBkb2N1bWVudCBjb250ZXh0LlxyXG5JZiB0aGUgYW5zd2VyIGNhbm5vdCBiZSBmb3VuZCBpbiB0aGUgcHJvdmlkZWQgY29udGV4dCwgY2xlYXJseSBzdGF0ZSB0aGF0IHRoZSBpbmZvcm1hdGlvbiBpcyBub3QgYXZhaWxhYmxlIGluIHRoZSBkb2N1bWVudC5cclxuRG8gbm90IG1ha2UgdXAgaW5mb3JtYXRpb24gb3IgdXNlIGV4dGVybmFsIGtub3dsZWRnZS4gQWx3YXlzIGNpdGUgd2hpY2ggcGFydCBvZiB0aGUgZG9jdW1lbnQgeW91J3JlIHJlZmVyZW5jaW5nLmA7XHJcblxyXG4iXSwibmFtZXMiOlsic2V0dGluZ3MiLCJHRU1JTklfQVBJX0tFWSIsInByb2Nlc3MiLCJlbnYiLCJNQVhfQ0hVTktfU0laRSIsIk51bWJlciIsIkNIVU5LX09WRVJMQVAiLCJNQVhfRklMRV9TSVpFX01CIiwiRU1CRURESU5HX01PREVMIiwiR0VNSU5JX01PREVMIiwiVEVNUEVSQVRVUkUiLCJNQVhfT1VUUFVUX1RPS0VOUyIsIkVOQUJMRV9PQ1IiLCJTdHJpbmciLCJFTkFCTEVfWU9VVFVCRSIsIlNZU1RFTV9QUk9NUFQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/settings.ts\n");

/***/ }),

/***/ "(rsc)/./lib/textChunker.ts":
/*!****************************!*\
  !*** ./lib/textChunker.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TextChunker: () => (/* binding */ TextChunker)\n/* harmony export */ });\nclass TextChunker {\n    constructor(chunkSize = 1000, overlap = 200){\n        this.chunkSize = chunkSize;\n        this.overlap = overlap;\n    }\n    chunkBySentences(text, maxChunkSize) {\n        const limit = maxChunkSize ?? this.chunkSize;\n        const sentences = text.replace(/!/g, \".\").replace(/\\?/g, \".\").split(\".\").map((s)=>s.trim()).filter(Boolean);\n        const chunks = [];\n        let current = [];\n        let size = 0;\n        let id = 0;\n        for (const sentence of sentences){\n            const sentSize = sentence.split(/\\s+/).length;\n            if (size + sentSize > limit && current.length) {\n                chunks.push({\n                    id,\n                    text: current.join(\". \") + \".\",\n                    sentence_count: current.length,\n                    token_count: size\n                });\n                id += 1;\n                if (this.overlap > 0 && current.length > 1) {\n                    current = current.slice(-1);\n                    size = current[0].split(/\\s+/).length;\n                } else {\n                    current = [];\n                    size = 0;\n                }\n            }\n            current.push(sentence);\n            size += sentSize;\n        }\n        if (current.length) {\n            chunks.push({\n                id,\n                text: current.join(\". \") + \".\",\n                sentence_count: current.length,\n                token_count: size\n            });\n        }\n        return chunks;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdGV4dENodW5rZXIudHMiLCJtYXBwaW5ncyI6Ijs7OztBQVNPLE1BQU1BO0lBSVhDLFlBQVlDLFlBQW9CLElBQUksRUFBRUMsVUFBa0IsR0FBRyxDQUFFO1FBQzNELElBQUksQ0FBQ0QsU0FBUyxHQUFHQTtRQUNqQixJQUFJLENBQUNDLE9BQU8sR0FBR0E7SUFDakI7SUFFQUMsaUJBQWlCQyxJQUFZLEVBQUVDLFlBQXFCLEVBQVc7UUFDN0QsTUFBTUMsUUFBUUQsZ0JBQWdCLElBQUksQ0FBQ0osU0FBUztRQUM1QyxNQUFNTSxZQUFZSCxLQUFLSSxPQUFPLENBQUMsTUFBTSxLQUFLQSxPQUFPLENBQUMsT0FBTyxLQUFLQyxLQUFLLENBQUMsS0FBS0MsR0FBRyxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFQyxJQUFJLElBQUlDLE1BQU0sQ0FBQ0M7UUFDbkcsTUFBTUMsU0FBa0IsRUFBRTtRQUMxQixJQUFJQyxVQUFvQixFQUFFO1FBQzFCLElBQUlDLE9BQU87UUFDWCxJQUFJQyxLQUFLO1FBRVQsS0FBSyxNQUFNQyxZQUFZWixVQUFXO1lBQ2hDLE1BQU1hLFdBQVdELFNBQVNWLEtBQUssQ0FBQyxPQUFPWSxNQUFNO1lBQzdDLElBQUlKLE9BQU9HLFdBQVdkLFNBQVNVLFFBQVFLLE1BQU0sRUFBRTtnQkFDN0NOLE9BQU9PLElBQUksQ0FBQztvQkFBRUo7b0JBQUlkLE1BQU1ZLFFBQVFPLElBQUksQ0FBQyxRQUFRO29CQUFLQyxnQkFBZ0JSLFFBQVFLLE1BQU07b0JBQUVJLGFBQWFSO2dCQUFLO2dCQUNwR0MsTUFBTTtnQkFDTixJQUFJLElBQUksQ0FBQ2hCLE9BQU8sR0FBRyxLQUFLYyxRQUFRSyxNQUFNLEdBQUcsR0FBRztvQkFDMUNMLFVBQVVBLFFBQVFVLEtBQUssQ0FBQyxDQUFDO29CQUN6QlQsT0FBT0QsT0FBTyxDQUFDLEVBQUUsQ0FBQ1AsS0FBSyxDQUFDLE9BQU9ZLE1BQU07Z0JBQ3ZDLE9BQU87b0JBQ0xMLFVBQVUsRUFBRTtvQkFDWkMsT0FBTztnQkFDVDtZQUNGO1lBQ0FELFFBQVFNLElBQUksQ0FBQ0g7WUFDYkYsUUFBUUc7UUFDVjtRQUNBLElBQUlKLFFBQVFLLE1BQU0sRUFBRTtZQUNsQk4sT0FBT08sSUFBSSxDQUFDO2dCQUFFSjtnQkFBSWQsTUFBTVksUUFBUU8sSUFBSSxDQUFDLFFBQVE7Z0JBQUtDLGdCQUFnQlIsUUFBUUssTUFBTTtnQkFBRUksYUFBYVI7WUFBSztRQUN0RztRQUNBLE9BQU9GO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2RvY3MtY2hhdC1uZXh0Ly4vbGliL3RleHRDaHVua2VyLnRzPzc4NDAiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHR5cGUgQ2h1bmsgPSB7XHJcbiAgaWQ6IG51bWJlcjtcclxuICB0ZXh0OiBzdHJpbmc7XHJcbiAgdG9rZW5fY291bnQ/OiBudW1iZXI7XHJcbiAgc2VudGVuY2VfY291bnQ/OiBudW1iZXI7XHJcbiAgc3RhcnRfcG9zPzogbnVtYmVyO1xyXG4gIGVuZF9wb3M/OiBudW1iZXI7XHJcbn07XHJcblxyXG5leHBvcnQgY2xhc3MgVGV4dENodW5rZXIge1xyXG4gIHByaXZhdGUgY2h1bmtTaXplOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBvdmVybGFwOiBudW1iZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNodW5rU2l6ZTogbnVtYmVyID0gMTAwMCwgb3ZlcmxhcDogbnVtYmVyID0gMjAwKSB7XHJcbiAgICB0aGlzLmNodW5rU2l6ZSA9IGNodW5rU2l6ZTtcclxuICAgIHRoaXMub3ZlcmxhcCA9IG92ZXJsYXA7XHJcbiAgfVxyXG5cclxuICBjaHVua0J5U2VudGVuY2VzKHRleHQ6IHN0cmluZywgbWF4Q2h1bmtTaXplPzogbnVtYmVyKTogQ2h1bmtbXSB7XHJcbiAgICBjb25zdCBsaW1pdCA9IG1heENodW5rU2l6ZSA/PyB0aGlzLmNodW5rU2l6ZTtcclxuICAgIGNvbnN0IHNlbnRlbmNlcyA9IHRleHQucmVwbGFjZSgvIS9nLCBcIi5cIikucmVwbGFjZSgvXFw/L2csIFwiLlwiKS5zcGxpdChcIi5cIikubWFwKHMgPT4gcy50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcclxuICAgIGNvbnN0IGNodW5rczogQ2h1bmtbXSA9IFtdO1xyXG4gICAgbGV0IGN1cnJlbnQ6IHN0cmluZ1tdID0gW107XHJcbiAgICBsZXQgc2l6ZSA9IDA7XHJcbiAgICBsZXQgaWQgPSAwO1xyXG5cclxuICAgIGZvciAoY29uc3Qgc2VudGVuY2Ugb2Ygc2VudGVuY2VzKSB7XHJcbiAgICAgIGNvbnN0IHNlbnRTaXplID0gc2VudGVuY2Uuc3BsaXQoL1xccysvKS5sZW5ndGg7XHJcbiAgICAgIGlmIChzaXplICsgc2VudFNpemUgPiBsaW1pdCAmJiBjdXJyZW50Lmxlbmd0aCkge1xyXG4gICAgICAgIGNodW5rcy5wdXNoKHsgaWQsIHRleHQ6IGN1cnJlbnQuam9pbignLiAnKSArICcuJywgc2VudGVuY2VfY291bnQ6IGN1cnJlbnQubGVuZ3RoLCB0b2tlbl9jb3VudDogc2l6ZSB9KTtcclxuICAgICAgICBpZCArPSAxO1xyXG4gICAgICAgIGlmICh0aGlzLm92ZXJsYXAgPiAwICYmIGN1cnJlbnQubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQuc2xpY2UoLTEpO1xyXG4gICAgICAgICAgc2l6ZSA9IGN1cnJlbnRbMF0uc3BsaXQoL1xccysvKS5sZW5ndGg7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGN1cnJlbnQgPSBbXTtcclxuICAgICAgICAgIHNpemUgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBjdXJyZW50LnB1c2goc2VudGVuY2UpO1xyXG4gICAgICBzaXplICs9IHNlbnRTaXplO1xyXG4gICAgfVxyXG4gICAgaWYgKGN1cnJlbnQubGVuZ3RoKSB7XHJcbiAgICAgIGNodW5rcy5wdXNoKHsgaWQsIHRleHQ6IGN1cnJlbnQuam9pbignLiAnKSArICcuJywgc2VudGVuY2VfY291bnQ6IGN1cnJlbnQubGVuZ3RoLCB0b2tlbl9jb3VudDogc2l6ZSB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBjaHVua3M7XHJcbiAgfVxyXG59XHJcblxyXG4iXSwibmFtZXMiOlsiVGV4dENodW5rZXIiLCJjb25zdHJ1Y3RvciIsImNodW5rU2l6ZSIsIm92ZXJsYXAiLCJjaHVua0J5U2VudGVuY2VzIiwidGV4dCIsIm1heENodW5rU2l6ZSIsImxpbWl0Iiwic2VudGVuY2VzIiwicmVwbGFjZSIsInNwbGl0IiwibWFwIiwicyIsInRyaW0iLCJmaWx0ZXIiLCJCb29sZWFuIiwiY2h1bmtzIiwiY3VycmVudCIsInNpemUiLCJpZCIsInNlbnRlbmNlIiwic2VudFNpemUiLCJsZW5ndGgiLCJwdXNoIiwiam9pbiIsInNlbnRlbmNlX2NvdW50IiwidG9rZW5fY291bnQiLCJzbGljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/textChunker.ts\n");

/***/ }),

/***/ "(rsc)/./lib/vectorStore.ts":
/*!****************************!*\
  !*** ./lib/vectorStore.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VectorStore: () => (/* binding */ VectorStore)\n/* harmony export */ });\n/* harmony import */ var _xenova_transformers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @xenova/transformers */ \"(rsc)/./node_modules/@xenova/transformers/src/transformers.js\");\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-sqlite3 */ \"better-sqlite3\");\n/* harmony import */ var better_sqlite3__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(better_sqlite3__WEBPACK_IMPORTED_MODULE_1__);\n\n\nclass VectorStore {\n    constructor(modelName, dbPath){\n        this.chunks = [];\n        this.embeddings = [];\n        this.embedderPromise = null;\n        this.db = null;\n        this.modelName = modelName;\n        this.useSqlite = Boolean(dbPath);\n        if (dbPath) {\n            this.db = new (better_sqlite3__WEBPACK_IMPORTED_MODULE_1___default())(dbPath);\n            this.initDb();\n            this.loadFromDb();\n        }\n    }\n    initDb() {\n        if (!this.db) return;\n        this.db.exec(`\r\n      CREATE TABLE IF NOT EXISTS chunks (\r\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n        text TEXT NOT NULL\r\n      );\r\n      CREATE TABLE IF NOT EXISTS embeddings (\r\n        chunk_id INTEGER PRIMARY KEY,\r\n        vector BLOB NOT NULL,\r\n        FOREIGN KEY(chunk_id) REFERENCES chunks(id) ON DELETE CASCADE\r\n      );\r\n    `);\n    }\n    loadFromDb() {\n        if (!this.db) return;\n        const rows = this.db.prepare(\"SELECT c.id, c.text, e.vector FROM chunks c JOIN embeddings e ON e.chunk_id = c.id ORDER BY c.id\").all();\n        this.chunks = rows.map((r)=>({\n                id: r.id,\n                text: r.text\n            }));\n        this.embeddings = rows.map((r)=>new Float32Array(Buffer.from(r.vector).buffer));\n    }\n    async getEmbedder() {\n        if (!this.embedderPromise) {\n            const model = this.modelName.includes(\"/\") ? this.modelName : `Xenova/${this.modelName}`;\n            this.embedderPromise = (0,_xenova_transformers__WEBPACK_IMPORTED_MODULE_0__.pipeline)(\"feature-extraction\", model);\n        }\n        return this.embedderPromise;\n    }\n    async addDocuments(chunks) {\n        if (!chunks.length) return;\n        const embedder = await this.getEmbedder();\n        const texts = chunks.map((c)=>c.text);\n        const outputs = await embedder(texts, {\n            pooling: \"mean\",\n            normalize: true\n        });\n        const vectors = outputs.tolist().map((row)=>new Float32Array(row));\n        if (this.db) {\n            const insertChunk = this.db.prepare(\"INSERT INTO chunks (text) VALUES (?)\");\n            const insertEmbedding = this.db.prepare(\"INSERT INTO embeddings (chunk_id, vector) VALUES (?, ?)\");\n            const trx = this.db.transaction((pairs)=>{\n                for (const { text, vector } of pairs){\n                    const result = insertChunk.run(text);\n                    const chunkId = result.lastInsertRowid;\n                    insertEmbedding.run(chunkId, Buffer.from(vector.buffer));\n                }\n            });\n            const pairs = chunks.map((chunk, i)=>({\n                    text: chunk.text,\n                    vector: vectors[i]\n                }));\n            trx(pairs);\n            this.loadFromDb();\n        } else {\n            // For in-memory mode, assign IDs sequentially based on existing chunks\n            const startId = this.chunks.length > 0 ? Math.max(...this.chunks.map((c)=>c.id)) + 1 : 0;\n            const chunksWithIds = chunks.map((chunk, i)=>({\n                    ...chunk,\n                    id: startId + i\n                }));\n            this.chunks.push(...chunksWithIds);\n            this.embeddings.push(...vectors);\n        }\n    }\n    async search(query, topK = 5) {\n        if (this.chunks.length === 0) return [];\n        const embedder = await this.getEmbedder();\n        const out = await embedder(query, {\n            pooling: \"mean\",\n            normalize: true\n        });\n        const q = new Float32Array(out.tolist()[0]);\n        const scores = this.embeddings.map((v)=>cosineSimilarity(q, v));\n        const indices = scores.map((s, i)=>[\n                s,\n                i\n            ]).sort((a, b)=>b[0] - a[0]).slice(0, Math.min(topK, scores.length));\n        return indices.map(([score, i])=>({\n                chunk: this.chunks[i],\n                score\n            }));\n    }\n    clear() {\n        this.chunks = [];\n        this.embeddings = [];\n        if (this.db) {\n            this.db.exec(\"DELETE FROM embeddings; DELETE FROM chunks;\");\n        }\n    }\n    getStats() {\n        return {\n            total_chunks: this.chunks.length,\n            dimension: this.embeddings[0]?.length || 0,\n            model_name: this.modelName,\n            index_size: this.embeddings.length\n        };\n    }\n}\nfunction cosineSimilarity(a, b) {\n    let dot = 0;\n    let na = 0;\n    let nb = 0;\n    for(let i = 0; i < a.length && i < b.length; i++){\n        dot += a[i] * b[i];\n        na += a[i] * a[i];\n        nb += b[i] * b[i];\n    }\n    if (na === 0 || nb === 0) return 0;\n    return dot / (Math.sqrt(na) * Math.sqrt(nb));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUUsR0FBR2tCLENBQUMsQ0FBQ2xCLEVBQUU7SUFDbkI7SUFDQSxJQUFJNkIsT0FBTyxLQUFLQyxPQUFPLEdBQUcsT0FBTztJQUNqQyxPQUFPRixNQUFPMUIsQ0FBQUEsS0FBSzZCLElBQUksQ0FBQ0YsTUFBTTNCLEtBQUs2QixJQUFJLENBQUNELEdBQUU7QUFDNUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kb2NzLWNoYXQtbmV4dC8uL2xpYi92ZWN0b3JTdG9yZS50cz80MzM4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBpcGVsaW5lIH0gZnJvbSBcIkB4ZW5vdmEvdHJhbnNmb3JtZXJzXCI7XHJcbmltcG9ydCB0eXBlIHsgQ2h1bmsgfSBmcm9tIFwiLi90ZXh0Q2h1bmtlclwiO1xyXG5pbXBvcnQgRGF0YWJhc2UgZnJvbSBcImJldHRlci1zcWxpdGUzXCI7XHJcblxyXG50eXBlIEVtYmVkZGluZyA9IEZsb2F0MzJBcnJheTtcclxuXHJcbmV4cG9ydCBjbGFzcyBWZWN0b3JTdG9yZSB7XHJcbiAgcHJpdmF0ZSBjaHVua3M6IENodW5rW10gPSBbXTtcclxuICBwcml2YXRlIGVtYmVkZGluZ3M6IEVtYmVkZGluZ1tdID0gW107XHJcbiAgcHJpdmF0ZSBlbWJlZGRlclByb21pc2U6IFByb21pc2U8YW55PiB8IG51bGwgPSBudWxsO1xyXG4gIHByaXZhdGUgbW9kZWxOYW1lOiBzdHJpbmc7XHJcbiAgcHJpdmF0ZSBkYjogRGF0YWJhc2UuRGF0YWJhc2UgfCBudWxsID0gbnVsbDtcclxuICBwcml2YXRlIHVzZVNxbGl0ZTogYm9vbGVhbjtcclxuXHJcbiAgY29uc3RydWN0b3IobW9kZWxOYW1lOiBzdHJpbmcsIGRiUGF0aD86IHN0cmluZykge1xyXG4gICAgdGhpcy5tb2RlbE5hbWUgPSBtb2RlbE5hbWU7XHJcbiAgICB0aGlzLnVzZVNxbGl0ZSA9IEJvb2xlYW4oZGJQYXRoKTtcclxuICAgIGlmIChkYlBhdGgpIHtcclxuICAgICAgdGhpcy5kYiA9IG5ldyBEYXRhYmFzZShkYlBhdGgpO1xyXG4gICAgICB0aGlzLmluaXREYigpO1xyXG4gICAgICB0aGlzLmxvYWRGcm9tRGIoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgaW5pdERiKCkge1xyXG4gICAgaWYgKCF0aGlzLmRiKSByZXR1cm47XHJcbiAgICB0aGlzLmRiLmV4ZWMoYFxyXG4gICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBjaHVua3MgKFxyXG4gICAgICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCxcclxuICAgICAgICB0ZXh0IFRFWFQgTk9UIE5VTExcclxuICAgICAgKTtcclxuICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgZW1iZWRkaW5ncyAoXHJcbiAgICAgICAgY2h1bmtfaWQgSU5URUdFUiBQUklNQVJZIEtFWSxcclxuICAgICAgICB2ZWN0b3IgQkxPQiBOT1QgTlVMTCxcclxuICAgICAgICBGT1JFSUdOIEtFWShjaHVua19pZCkgUkVGRVJFTkNFUyBjaHVua3MoaWQpIE9OIERFTEVURSBDQVNDQURFXHJcbiAgICAgICk7XHJcbiAgICBgKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgbG9hZEZyb21EYigpIHtcclxuICAgIGlmICghdGhpcy5kYikgcmV0dXJuO1xyXG4gICAgY29uc3Qgcm93cyA9IHRoaXMuZGIucHJlcGFyZShcIlNFTEVDVCBjLmlkLCBjLnRleHQsIGUudmVjdG9yIEZST00gY2h1bmtzIGMgSk9JTiBlbWJlZGRpbmdzIGUgT04gZS5jaHVua19pZCA9IGMuaWQgT1JERVIgQlkgYy5pZFwiKS5hbGwoKTtcclxuICAgIHRoaXMuY2h1bmtzID0gcm93cy5tYXAoKHI6IGFueSkgPT4gKHsgaWQ6IHIuaWQsIHRleHQ6IHIudGV4dCB9KSk7XHJcbiAgICB0aGlzLmVtYmVkZGluZ3MgPSByb3dzLm1hcCgocjogYW55KSA9PiBuZXcgRmxvYXQzMkFycmF5KEJ1ZmZlci5mcm9tKHIudmVjdG9yKS5idWZmZXIpKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZ2V0RW1iZWRkZXIoKSB7XHJcbiAgICBpZiAoIXRoaXMuZW1iZWRkZXJQcm9taXNlKSB7XHJcbiAgICAgIGNvbnN0IG1vZGVsID0gdGhpcy5tb2RlbE5hbWUuaW5jbHVkZXMoJy8nKSA/IHRoaXMubW9kZWxOYW1lIDogYFhlbm92YS8ke3RoaXMubW9kZWxOYW1lfWA7XHJcbiAgICAgIHRoaXMuZW1iZWRkZXJQcm9taXNlID0gcGlwZWxpbmUoXCJmZWF0dXJlLWV4dHJhY3Rpb25cIiwgbW9kZWwpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuZW1iZWRkZXJQcm9taXNlO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgYWRkRG9jdW1lbnRzKGNodW5rczogQ2h1bmtbXSk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCFjaHVua3MubGVuZ3RoKSByZXR1cm47XHJcbiAgICBjb25zdCBlbWJlZGRlciA9IGF3YWl0IHRoaXMuZ2V0RW1iZWRkZXIoKTtcclxuICAgIGNvbnN0IHRleHRzID0gY2h1bmtzLm1hcChjID0+IGMudGV4dCk7XHJcbiAgICBjb25zdCBvdXRwdXRzID0gYXdhaXQgZW1iZWRkZXIodGV4dHMsIHsgcG9vbGluZzogXCJtZWFuXCIsIG5vcm1hbGl6ZTogdHJ1ZSB9KTtcclxuICAgIGNvbnN0IHZlY3RvcnM6IEVtYmVkZGluZ1tdID0gb3V0cHV0cy50b2xpc3QoKS5tYXAoKHJvdzogbnVtYmVyW10pID0+IG5ldyBGbG9hdDMyQXJyYXkocm93KSk7XHJcbiAgICBpZiAodGhpcy5kYikge1xyXG4gICAgICBjb25zdCBpbnNlcnRDaHVuayA9IHRoaXMuZGIucHJlcGFyZShcIklOU0VSVCBJTlRPIGNodW5rcyAodGV4dCkgVkFMVUVTICg/KVwiKTtcclxuICAgICAgY29uc3QgaW5zZXJ0RW1iZWRkaW5nID0gdGhpcy5kYi5wcmVwYXJlKFwiSU5TRVJUIElOVE8gZW1iZWRkaW5ncyAoY2h1bmtfaWQsIHZlY3RvcikgVkFMVUVTICg/LCA/KVwiKTtcclxuICAgICAgY29uc3QgdHJ4ID0gdGhpcy5kYi50cmFuc2FjdGlvbigocGFpcnM6IHsgdGV4dDogc3RyaW5nOyB2ZWN0b3I6IEVtYmVkZGluZyB9W10pID0+IHtcclxuICAgICAgICBmb3IgKGNvbnN0IHsgdGV4dCwgdmVjdG9yIH0gb2YgcGFpcnMpIHtcclxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGluc2VydENodW5rLnJ1bih0ZXh0KTtcclxuICAgICAgICAgIGNvbnN0IGNodW5rSWQgPSByZXN1bHQubGFzdEluc2VydFJvd2lkO1xyXG4gICAgICAgICAgaW5zZXJ0RW1iZWRkaW5nLnJ1bihjaHVua0lkLCBCdWZmZXIuZnJvbSh2ZWN0b3IuYnVmZmVyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgY29uc3QgcGFpcnMgPSBjaHVua3MubWFwKChjaHVuaywgaSkgPT4gKHsgdGV4dDogY2h1bmsudGV4dCwgdmVjdG9yOiB2ZWN0b3JzW2ldIH0pKTtcclxuICAgICAgdHJ4KHBhaXJzKTtcclxuICAgICAgdGhpcy5sb2FkRnJvbURiKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBGb3IgaW4tbWVtb3J5IG1vZGUsIGFzc2lnbiBJRHMgc2VxdWVudGlhbGx5IGJhc2VkIG9uIGV4aXN0aW5nIGNodW5rc1xyXG4gICAgICBjb25zdCBzdGFydElkID0gdGhpcy5jaHVua3MubGVuZ3RoID4gMCA/IE1hdGgubWF4KC4uLnRoaXMuY2h1bmtzLm1hcChjID0+IGMuaWQpKSArIDEgOiAwO1xyXG4gICAgICBjb25zdCBjaHVua3NXaXRoSWRzID0gY2h1bmtzLm1hcCgoY2h1bmssIGkpID0+ICh7IC4uLmNodW5rLCBpZDogc3RhcnRJZCArIGkgfSkpO1xyXG4gICAgICB0aGlzLmNodW5rcy5wdXNoKC4uLmNodW5rc1dpdGhJZHMpO1xyXG4gICAgICB0aGlzLmVtYmVkZGluZ3MucHVzaCguLi52ZWN0b3JzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIHNlYXJjaChxdWVyeTogc3RyaW5nLCB0b3BLOiBudW1iZXIgPSA1KTogUHJvbWlzZTx7IGNodW5rOiBDaHVuazsgc2NvcmU6IG51bWJlciB9W10+IHtcclxuICAgIGlmICh0aGlzLmNodW5rcy5sZW5ndGggPT09IDApIHJldHVybiBbXTtcclxuICAgIGNvbnN0IGVtYmVkZGVyID0gYXdhaXQgdGhpcy5nZXRFbWJlZGRlcigpO1xyXG4gICAgY29uc3Qgb3V0ID0gYXdhaXQgZW1iZWRkZXIocXVlcnksIHsgcG9vbGluZzogXCJtZWFuXCIsIG5vcm1hbGl6ZTogdHJ1ZSB9KTtcclxuICAgIGNvbnN0IHEgPSBuZXcgRmxvYXQzMkFycmF5KG91dC50b2xpc3QoKVswXSk7XHJcbiAgICBjb25zdCBzY29yZXMgPSB0aGlzLmVtYmVkZGluZ3MubWFwKCh2KSA9PiBjb3NpbmVTaW1pbGFyaXR5KHEsIHYpKTtcclxuICAgIGNvbnN0IGluZGljZXMgPSBzY29yZXMubWFwKChzLCBpKSA9PiBbcywgaV0gYXMgY29uc3QpLnNvcnQoKGEsIGIpID0+IGJbMF0gLSBhWzBdKS5zbGljZSgwLCBNYXRoLm1pbih0b3BLLCBzY29yZXMubGVuZ3RoKSk7XHJcbiAgICByZXR1cm4gaW5kaWNlcy5tYXAoKFtzY29yZSwgaV0pID0+ICh7IGNodW5rOiB0aGlzLmNodW5rc1tpXSwgc2NvcmUgfSkpO1xyXG4gIH1cclxuXHJcbiAgY2xlYXIoKSB7XHJcbiAgICB0aGlzLmNodW5rcyA9IFtdO1xyXG4gICAgdGhpcy5lbWJlZGRpbmdzID0gW107XHJcbiAgICBpZiAodGhpcy5kYikge1xyXG4gICAgICB0aGlzLmRiLmV4ZWMoXCJERUxFVEUgRlJPTSBlbWJlZGRpbmdzOyBERUxFVEUgRlJPTSBjaHVua3M7XCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0U3RhdHMoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0b3RhbF9jaHVua3M6IHRoaXMuY2h1bmtzLmxlbmd0aCxcclxuICAgICAgZGltZW5zaW9uOiB0aGlzLmVtYmVkZGluZ3NbMF0/Lmxlbmd0aCB8fCAwLFxyXG4gICAgICBtb2RlbF9uYW1lOiB0aGlzLm1vZGVsTmFtZSxcclxuICAgICAgaW5kZXhfc2l6ZTogdGhpcy5lbWJlZGRpbmdzLmxlbmd0aCxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjb3NpbmVTaW1pbGFyaXR5KGE6IEZsb2F0MzJBcnJheSwgYjogRmxvYXQzMkFycmF5KTogbnVtYmVyIHtcclxuICBsZXQgZG90ID0gMDtcclxuICBsZXQgbmEgPSAwO1xyXG4gIGxldCBuYiA9IDA7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhLmxlbmd0aCAmJiBpIDwgYi5sZW5ndGg7IGkrKykge1xyXG4gICAgZG90ICs9IGFbaV0gKiBiW2ldO1xyXG4gICAgbmEgKz0gYVtpXSAqIGFbaV07XHJcbiAgICBuYiArPSBiW2ldICogYltpXTtcclxuICB9XHJcbiAgaWYgKG5hID09PSAwIHx8IG5iID09PSAwKSByZXR1cm4gMDtcclxuICByZXR1cm4gZG90IC8gKE1hdGguc3FydChuYSkgKiBNYXRoLnNxcnQobmIpKTtcclxufVxyXG5cclxuIl0sIm5hbWVzIjpbInBpcGVsaW5lIiwiRGF0YWJhc2UiLCJWZWN0b3JTdG9yZSIsImNvbnN0cnVjdG9yIiwibW9kZWxOYW1lIiwiZGJQYXRoIiwiY2h1bmtzIiwiZW1iZWRkaW5ncyIsImVtYmVkZGVyUHJvbWlzZSIsImRiIiwidXNlU3FsaXRlIiwiQm9vbGVhbiIsImluaXREYiIsImxvYWRGcm9tRGIiLCJleGVjIiwicm93cyIsInByZXBhcmUiLCJhbGwiLCJtYXAiLCJyIiwiaWQiLCJ0ZXh0IiwiRmxvYXQzMkFycmF5IiwiQnVmZmVyIiwiZnJvbSIsInZlY3RvciIsImJ1ZmZlciIsImdldEVtYmVkZGVyIiwibW9kZWwiLCJpbmNsdWRlcyIsImFkZERvY3VtZW50cyIsImxlbmd0aCIsImVtYmVkZGVyIiwidGV4dHMiLCJjIiwib3V0cHV0cyIsInBvb2xpbmciLCJub3JtYWxpemUiLCJ2ZWN0b3JzIiwidG9saXN0Iiwicm93IiwiaW5zZXJ0Q2h1bmsiLCJpbnNlcnRFbWJlZGRpbmciLCJ0cngiLCJ0cmFuc2FjdGlvbiIsInBhaXJzIiwicmVzdWx0IiwicnVuIiwiY2h1bmtJZCIsImxhc3RJbnNlcnRSb3dpZCIsImNodW5rIiwiaSIsInN0YXJ0SWQiLCJNYXRoIiwibWF4IiwiY2h1bmtzV2l0aElkcyIsInB1c2giLCJzZWFyY2giLCJxdWVyeSIsInRvcEsiLCJvdXQiLCJxIiwic2NvcmVzIiwidiIsImNvc2luZVNpbWlsYXJpdHkiLCJpbmRpY2VzIiwicyIsInNvcnQiLCJhIiwiYiIsInNsaWNlIiwibWluIiwic2NvcmUiLCJjbGVhciIsImdldFN0YXRzIiwidG90YWxfY2h1bmtzIiwiZGltZW5zaW9uIiwibW9kZWxfbmFtZSIsImluZGV4X3NpemUiLCJkb3QiLCJuYSIsIm5iIiwic3FydCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/vectorStore.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@xenova","vendor-chunks/onnxruntime-web","vendor-chunks/@huggingface","vendor-chunks/onnxruntime-common","vendor-chunks/@google","vendor-chunks/remove-markdown"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();