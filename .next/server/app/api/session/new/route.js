"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/session/new/route";
exports.ids = ["app/api/session/new/route"];
exports.modules = {

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "onnxruntime-node":
/*!***********************************!*\
  !*** external "onnxruntime-node" ***!
  \***********************************/
/***/ ((module) => {

module.exports = require("onnxruntime-node");

/***/ }),

/***/ "sharp":
/*!************************!*\
  !*** external "sharp" ***!
  \************************/
/***/ ((module) => {

module.exports = require("sharp");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:path");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "perf_hooks":
/*!*****************************!*\
  !*** external "perf_hooks" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("perf_hooks");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsession%2Fnew%2Froute&page=%2Fapi%2Fsession%2Fnew%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsession%2Fnew%2Froute.ts&appDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsession%2Fnew%2Froute&page=%2Fapi%2Fsession%2Fnew%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsession%2Fnew%2Froute.ts&appDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_komar_Desktop_docs_chat_master_docs_chat_master_app_api_session_new_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/session/new/route.ts */ \"(rsc)/./app/api/session/new/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/session/new/route\",\n        pathname: \"/api/session/new\",\n        filename: \"route\",\n        bundlePath: \"app/api/session/new/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\komar\\\\Desktop\\\\docs-chat-master\\\\docs-chat-master\\\\app\\\\api\\\\session\\\\new\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_komar_Desktop_docs_chat_master_docs_chat_master_app_api_session_new_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/session/new/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzZXNzaW9uJTJGbmV3JTJGcm91dGUmcGFnZT0lMkZhcGklMkZzZXNzaW9uJTJGbmV3JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGc2Vzc2lvbiUyRm5ldyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNrb21hciU1Q0Rlc2t0b3AlNUNkb2NzLWNoYXQtbWFzdGVyJTVDZG9jcy1jaGF0LW1hc3RlciU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDa29tYXIlNUNEZXNrdG9wJTVDZG9jcy1jaGF0LW1hc3RlciU1Q2RvY3MtY2hhdC1tYXN0ZXImaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQytDO0FBQzVIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZG9jcy1jaGF0LW5leHQvPzMxYmIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxca29tYXJcXFxcRGVza3RvcFxcXFxkb2NzLWNoYXQtbWFzdGVyXFxcXGRvY3MtY2hhdC1tYXN0ZXJcXFxcYXBwXFxcXGFwaVxcXFxzZXNzaW9uXFxcXG5ld1xcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc2Vzc2lvbi9uZXcvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9zZXNzaW9uL25ld1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvc2Vzc2lvbi9uZXcvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxrb21hclxcXFxEZXNrdG9wXFxcXGRvY3MtY2hhdC1tYXN0ZXJcXFxcZG9jcy1jaGF0LW1hc3RlclxcXFxhcHBcXFxcYXBpXFxcXHNlc3Npb25cXFxcbmV3XFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zZXNzaW9uL25ldy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsession%2Fnew%2Froute&page=%2Fapi%2Fsession%2Fnew%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsession%2Fnew%2Froute.ts&appDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/_state.ts":
/*!***************************!*\
  !*** ./app/api/_state.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   chunker: () => (/* binding */ chunker),\n/* harmony export */   mediaFiles: () => (/* binding */ mediaFiles),\n/* harmony export */   sessions: () => (/* binding */ sessions),\n/* harmony export */   store: () => (/* binding */ store)\n/* harmony export */ });\n/* harmony import */ var _lib_settings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/settings */ \"(rsc)/./lib/settings.ts\");\n/* harmony import */ var _lib_textChunker__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/textChunker */ \"(rsc)/./lib/textChunker.ts\");\n/* harmony import */ var _lib_vectorStore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/vectorStore */ \"(rsc)/./lib/vectorStore.ts\");\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! node:path */ \"node:path\");\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(node_path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var node_fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! node:fs */ \"node:fs\");\n/* harmony import */ var node_fs__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(node_fs__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nconst chunker = new _lib_textChunker__WEBPACK_IMPORTED_MODULE_1__.TextChunker(_lib_settings__WEBPACK_IMPORTED_MODULE_0__.settings.MAX_CHUNK_SIZE, _lib_settings__WEBPACK_IMPORTED_MODULE_0__.settings.CHUNK_OVERLAP);\n// Initialize VectorStore with MongoDB (singleton pattern for Next.js)\nif (!global.__vectorStore) {\n    console.log(\"Initializing new VectorStore instance...\");\n    global.__vectorStore = new _lib_vectorStore__WEBPACK_IMPORTED_MODULE_2__.VectorStore(_lib_settings__WEBPACK_IMPORTED_MODULE_0__.settings.EMBEDDING_MODEL, _lib_settings__WEBPACK_IMPORTED_MODULE_0__.settings.MONGODB_URI, _lib_settings__WEBPACK_IMPORTED_MODULE_0__.settings.MONGODB_DB_NAME);\n}\nif (!global.__sessions) {\n    global.__sessions = new Map();\n}\nif (!global.__mediaFiles) {\n    global.__mediaFiles = new Map();\n}\nconst store = global.__vectorStore;\nconst sessions = global.__sessions;\nconst mediaFiles = global.__mediaFiles;\n// Create uploads directory if it doesn't exist\nconst uploadsDir = node_path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \"uploads\");\ntry {\n    if (!node_fs__WEBPACK_IMPORTED_MODULE_4___default().existsSync(uploadsDir)) {\n        node_fs__WEBPACK_IMPORTED_MODULE_4___default().mkdirSync(uploadsDir, {\n            recursive: true\n        });\n    }\n} catch  {}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL19zdGF0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUEwQztBQUNNO0FBQ0E7QUFDbkI7QUFDSjtBQVlsQixNQUFNSyxVQUFVLElBQUlKLHlEQUFXQSxDQUFDRCxtREFBUUEsQ0FBQ00sY0FBYyxFQUFFTixtREFBUUEsQ0FBQ08sYUFBYSxFQUFFO0FBU3hGLHNFQUFzRTtBQUN0RSxJQUFJLENBQUNDLE9BQU9DLGFBQWEsRUFBRTtJQUN6QkMsUUFBUUMsR0FBRyxDQUFDO0lBQ1pILE9BQU9DLGFBQWEsR0FBRyxJQUFJUCx5REFBV0EsQ0FDcENGLG1EQUFRQSxDQUFDWSxlQUFlLEVBQ3hCWixtREFBUUEsQ0FBQ2EsV0FBVyxFQUNwQmIsbURBQVFBLENBQUNjLGVBQWU7QUFFNUI7QUFFQSxJQUFJLENBQUNOLE9BQU9PLFVBQVUsRUFBRTtJQUN0QlAsT0FBT08sVUFBVSxHQUFHLElBQUlDO0FBQzFCO0FBRUEsSUFBSSxDQUFDUixPQUFPUyxZQUFZLEVBQUU7SUFDeEJULE9BQU9TLFlBQVksR0FBRyxJQUFJRDtBQUM1QjtBQUVPLE1BQU1FLFFBQVFWLE9BQU9DLGFBQWEsQ0FBQztBQUNuQyxNQUFNVSxXQUFXWCxPQUFPTyxVQUFVLENBQUM7QUFDbkMsTUFBTUssYUFBYVosT0FBT1MsWUFBWSxDQUFDO0FBRTlDLCtDQUErQztBQUMvQyxNQUFNSSxhQUFhbEIscURBQVMsQ0FBQ29CLFFBQVFDLEdBQUcsSUFBSTtBQUM1QyxJQUFJO0lBQ0YsSUFBSSxDQUFDcEIseURBQWEsQ0FBQ2lCLGFBQWE7UUFDOUJqQix3REFBWSxDQUFDaUIsWUFBWTtZQUFFTSxXQUFXO1FBQUs7SUFDN0M7QUFDRixFQUFFLE9BQU0sQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2RvY3MtY2hhdC1uZXh0Ly4vYXBwL2FwaS9fc3RhdGUudHM/NGFjNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzZXR0aW5ncyB9IGZyb20gXCJAL2xpYi9zZXR0aW5nc1wiO1xyXG5pbXBvcnQgeyBUZXh0Q2h1bmtlciB9IGZyb20gXCJAL2xpYi90ZXh0Q2h1bmtlclwiO1xyXG5pbXBvcnQgeyBWZWN0b3JTdG9yZSB9IGZyb20gXCJAL2xpYi92ZWN0b3JTdG9yZVwiO1xyXG5pbXBvcnQgcGF0aCBmcm9tIFwibm9kZTpwYXRoXCI7XHJcbmltcG9ydCBmcyBmcm9tIFwibm9kZTpmc1wiO1xyXG5cclxuZXhwb3J0IHR5cGUgQ2hhdE1lc3NhZ2UgPSB7IHJvbGU6IFwidXNlclwiIHwgXCJhc3Npc3RhbnRcIjsgY29udGVudDogc3RyaW5nIH07XHJcblxyXG5leHBvcnQgdHlwZSBNZWRpYUZpbGUgPSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBmaWxlUGF0aDogc3RyaW5nO1xyXG4gIG1pbWVUeXBlOiBzdHJpbmc7XHJcbiAgb3JpZ2luYWxOYW1lOiBzdHJpbmc7XHJcbiAgdHlwZTogXCJpbWFnZVwiIHwgXCJ2aWRlb1wiIHwgXCJhdWRpb1wiO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNodW5rZXIgPSBuZXcgVGV4dENodW5rZXIoc2V0dGluZ3MuTUFYX0NIVU5LX1NJWkUsIHNldHRpbmdzLkNIVU5LX09WRVJMQVApO1xyXG5cclxuLy8gVXNlIGdsb2JhbCB0byBlbnN1cmUgc2luZ2xldG9uIGFjcm9zcyBOZXh0LmpzIGhvdCByZWxvYWRzXHJcbmRlY2xhcmUgZ2xvYmFsIHtcclxuICB2YXIgX192ZWN0b3JTdG9yZTogVmVjdG9yU3RvcmUgfCB1bmRlZmluZWQ7XHJcbiAgdmFyIF9fc2Vzc2lvbnM6IE1hcDxzdHJpbmcsIENoYXRNZXNzYWdlW10+IHwgdW5kZWZpbmVkO1xyXG4gIHZhciBfX21lZGlhRmlsZXM6IE1hcDxzdHJpbmcsIE1lZGlhRmlsZT4gfCB1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8vIEluaXRpYWxpemUgVmVjdG9yU3RvcmUgd2l0aCBNb25nb0RCIChzaW5nbGV0b24gcGF0dGVybiBmb3IgTmV4dC5qcylcclxuaWYgKCFnbG9iYWwuX192ZWN0b3JTdG9yZSkge1xyXG4gIGNvbnNvbGUubG9nKFwiSW5pdGlhbGl6aW5nIG5ldyBWZWN0b3JTdG9yZSBpbnN0YW5jZS4uLlwiKTtcclxuICBnbG9iYWwuX192ZWN0b3JTdG9yZSA9IG5ldyBWZWN0b3JTdG9yZShcclxuICAgIHNldHRpbmdzLkVNQkVERElOR19NT0RFTCxcclxuICAgIHNldHRpbmdzLk1PTkdPREJfVVJJLFxyXG4gICAgc2V0dGluZ3MuTU9OR09EQl9EQl9OQU1FXHJcbiAgKTtcclxufVxyXG5cclxuaWYgKCFnbG9iYWwuX19zZXNzaW9ucykge1xyXG4gIGdsb2JhbC5fX3Nlc3Npb25zID0gbmV3IE1hcDxzdHJpbmcsIENoYXRNZXNzYWdlW10+KCk7XHJcbn1cclxuXHJcbmlmICghZ2xvYmFsLl9fbWVkaWFGaWxlcykge1xyXG4gIGdsb2JhbC5fX21lZGlhRmlsZXMgPSBuZXcgTWFwPHN0cmluZywgTWVkaWFGaWxlPigpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3Qgc3RvcmUgPSBnbG9iYWwuX192ZWN0b3JTdG9yZTtcclxuZXhwb3J0IGNvbnN0IHNlc3Npb25zID0gZ2xvYmFsLl9fc2Vzc2lvbnM7XHJcbmV4cG9ydCBjb25zdCBtZWRpYUZpbGVzID0gZ2xvYmFsLl9fbWVkaWFGaWxlcztcclxuXHJcbi8vIENyZWF0ZSB1cGxvYWRzIGRpcmVjdG9yeSBpZiBpdCBkb2Vzbid0IGV4aXN0XHJcbmNvbnN0IHVwbG9hZHNEaXIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgXCJ1cGxvYWRzXCIpO1xyXG50cnkge1xyXG4gIGlmICghZnMuZXhpc3RzU3luYyh1cGxvYWRzRGlyKSkge1xyXG4gICAgZnMubWtkaXJTeW5jKHVwbG9hZHNEaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xyXG4gIH1cclxufSBjYXRjaCB7fVxyXG5cclxuIl0sIm5hbWVzIjpbInNldHRpbmdzIiwiVGV4dENodW5rZXIiLCJWZWN0b3JTdG9yZSIsInBhdGgiLCJmcyIsImNodW5rZXIiLCJNQVhfQ0hVTktfU0laRSIsIkNIVU5LX09WRVJMQVAiLCJnbG9iYWwiLCJfX3ZlY3RvclN0b3JlIiwiY29uc29sZSIsImxvZyIsIkVNQkVERElOR19NT0RFTCIsIk1PTkdPREJfVVJJIiwiTU9OR09EQl9EQl9OQU1FIiwiX19zZXNzaW9ucyIsIk1hcCIsIl9fbWVkaWFGaWxlcyIsInN0b3JlIiwic2Vzc2lvbnMiLCJtZWRpYUZpbGVzIiwidXBsb2Fkc0RpciIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/_state.ts\n");

/***/ }),

/***/ "(rsc)/./app/api/session/new/route.ts":
/*!**************************************!*\
  !*** ./app/api/session/new/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../_state */ \"(rsc)/./app/api/_state.ts\");\n\n\nconst runtime = \"nodejs\";\nasync function POST() {\n    const id = crypto.randomUUID();\n    _state__WEBPACK_IMPORTED_MODULE_1__.sessions.set(id, []);\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        session_id: id,\n        message: \"New session created\"\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3Nlc3Npb24vbmV3L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBMkM7QUFDSDtBQUVqQyxNQUFNRSxVQUFVLFNBQVM7QUFFekIsZUFBZUM7SUFDcEIsTUFBTUMsS0FBS0MsT0FBT0MsVUFBVTtJQUM1QkwsNENBQVFBLENBQUNNLEdBQUcsQ0FBQ0gsSUFBSSxFQUFFO0lBQ25CLE9BQU9KLHFEQUFZQSxDQUFDUSxJQUFJLENBQUM7UUFBRUMsWUFBWUw7UUFBSU0sU0FBUztJQUFzQjtBQUM1RSIsInNvdXJjZXMiOlsid2VicGFjazovL2RvY3MtY2hhdC1uZXh0Ly4vYXBwL2FwaS9zZXNzaW9uL25ldy9yb3V0ZS50cz8xNTQ1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xyXG5pbXBvcnQgeyBzZXNzaW9ucyB9IGZyb20gXCIuLi8uLi9fc3RhdGVcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBydW50aW1lID0gXCJub2RlanNcIjtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKCkge1xyXG4gIGNvbnN0IGlkID0gY3J5cHRvLnJhbmRvbVVVSUQoKTtcclxuICBzZXNzaW9ucy5zZXQoaWQsIFtdKTtcclxuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzZXNzaW9uX2lkOiBpZCwgbWVzc2FnZTogXCJOZXcgc2Vzc2lvbiBjcmVhdGVkXCIgfSk7XHJcbn1cclxuXHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJzZXNzaW9ucyIsInJ1bnRpbWUiLCJQT1NUIiwiaWQiLCJjcnlwdG8iLCJyYW5kb21VVUlEIiwic2V0IiwianNvbiIsInNlc3Npb25faWQiLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/session/new/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/settings.ts":
/*!*************************!*\
  !*** ./lib/settings.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SYSTEM_PROMPT: () => (/* binding */ SYSTEM_PROMPT),\n/* harmony export */   settings: () => (/* binding */ settings)\n/* harmony export */ });\nconst settings = {\n    GEMINI_API_KEY: process.env.GEMINI_API_KEY || \"\",\n    MAX_CHUNK_SIZE: Number(process.env.MAX_CHUNK_SIZE || 1000),\n    CHUNK_OVERLAP: Number(process.env.CHUNK_OVERLAP || 200),\n    MAX_FILE_SIZE_MB: Number(process.env.MAX_FILE_SIZE_MB || 50),\n    EMBEDDING_MODEL: process.env.EMBEDDING_MODEL || \"Xenova/all-MiniLM-L6-v2\",\n    GEMINI_MODEL: process.env.GEMINI_MODEL || \"gemini-2.0-flash-exp\",\n    TEMPERATURE: Number(process.env.TEMPERATURE || 0.7),\n    MAX_OUTPUT_TOKENS: Number(process.env.MAX_OUTPUT_TOKENS || 2048),\n    ENABLE_OCR: String(process.env.ENABLE_OCR || \"true\") === \"true\",\n    ENABLE_YOUTUBE: String(process.env.ENABLE_YOUTUBE || \"true\") === \"true\",\n    MONGODB_URI: process.env.MONGODB_URI || \"mongodb://localhost:27017\",\n    MONGODB_DB_NAME: process.env.MONGODB_DB_NAME || \"docs-chat\"\n};\nconst SYSTEM_PROMPT = `You are a helpful assistant that answers questions based on the provided document context and any images provided.\r\nWhen answering:\r\n1. Use the document context provided to answer the question as accurately as possible\r\n2. If images are provided, analyze them carefully and describe what you see\r\n3. If the information is partially available in the context, provide what you can find and mention what might be missing\r\n4. If the answer cannot be found in the provided context or images, clearly state that the specific information is not available\r\n5. Be helpful and provide relevant information even if it's not an exact match to the question\r\n6. Always cite which part of the document or image you're referencing when possible`;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2V0dGluZ3MudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFlTyxNQUFNQSxXQUFxQjtJQUNoQ0MsZ0JBQWdCQyxRQUFRQyxHQUFHLENBQUNGLGNBQWMsSUFBSTtJQUM5Q0csZ0JBQWdCQyxPQUFPSCxRQUFRQyxHQUFHLENBQUNDLGNBQWMsSUFBSTtJQUNyREUsZUFBZUQsT0FBT0gsUUFBUUMsR0FBRyxDQUFDRyxhQUFhLElBQUk7SUFDbkRDLGtCQUFrQkYsT0FBT0gsUUFBUUMsR0FBRyxDQUFDSSxnQkFBZ0IsSUFBSTtJQUN6REMsaUJBQWlCTixRQUFRQyxHQUFHLENBQUNLLGVBQWUsSUFBSTtJQUNoREMsY0FBY1AsUUFBUUMsR0FBRyxDQUFDTSxZQUFZLElBQUk7SUFDMUNDLGFBQWFMLE9BQU9ILFFBQVFDLEdBQUcsQ0FBQ08sV0FBVyxJQUFJO0lBQy9DQyxtQkFBbUJOLE9BQU9ILFFBQVFDLEdBQUcsQ0FBQ1EsaUJBQWlCLElBQUk7SUFDM0RDLFlBQVlDLE9BQU9YLFFBQVFDLEdBQUcsQ0FBQ1MsVUFBVSxJQUFJLFlBQVk7SUFDekRFLGdCQUFnQkQsT0FBT1gsUUFBUUMsR0FBRyxDQUFDVyxjQUFjLElBQUksWUFBWTtJQUNqRUMsYUFBYWIsUUFBUUMsR0FBRyxDQUFDWSxXQUFXLElBQUk7SUFDeENDLGlCQUFpQmQsUUFBUUMsR0FBRyxDQUFDYSxlQUFlLElBQUk7QUFDbEQsRUFBRTtBQUVLLE1BQU1DLGdCQUFnQixDQUFDOzs7Ozs7O21GQU9xRCxDQUFDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kb2NzLWNoYXQtbmV4dC8uL2xpYi9zZXR0aW5ncy50cz8xZDcyIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB0eXBlIFNldHRpbmdzID0ge1xyXG4gIEdFTUlOSV9BUElfS0VZOiBzdHJpbmc7XHJcbiAgTUFYX0NIVU5LX1NJWkU6IG51bWJlcjtcclxuICBDSFVOS19PVkVSTEFQOiBudW1iZXI7XHJcbiAgTUFYX0ZJTEVfU0laRV9NQjogbnVtYmVyO1xyXG4gIEVNQkVERElOR19NT0RFTDogc3RyaW5nO1xyXG4gIEdFTUlOSV9NT0RFTDogc3RyaW5nO1xyXG4gIFRFTVBFUkFUVVJFOiBudW1iZXI7XHJcbiAgTUFYX09VVFBVVF9UT0tFTlM6IG51bWJlcjtcclxuICBFTkFCTEVfT0NSOiBib29sZWFuO1xyXG4gIEVOQUJMRV9ZT1VUVUJFOiBib29sZWFuO1xyXG4gIE1PTkdPREJfVVJJOiBzdHJpbmc7XHJcbiAgTU9OR09EQl9EQl9OQU1FOiBzdHJpbmc7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc2V0dGluZ3M6IFNldHRpbmdzID0ge1xyXG4gIEdFTUlOSV9BUElfS0VZOiBwcm9jZXNzLmVudi5HRU1JTklfQVBJX0tFWSB8fCBcIlwiLFxyXG4gIE1BWF9DSFVOS19TSVpFOiBOdW1iZXIocHJvY2Vzcy5lbnYuTUFYX0NIVU5LX1NJWkUgfHwgMTAwMCksXHJcbiAgQ0hVTktfT1ZFUkxBUDogTnVtYmVyKHByb2Nlc3MuZW52LkNIVU5LX09WRVJMQVAgfHwgMjAwKSxcclxuICBNQVhfRklMRV9TSVpFX01COiBOdW1iZXIocHJvY2Vzcy5lbnYuTUFYX0ZJTEVfU0laRV9NQiB8fCA1MCksXHJcbiAgRU1CRURESU5HX01PREVMOiBwcm9jZXNzLmVudi5FTUJFRERJTkdfTU9ERUwgfHwgXCJYZW5vdmEvYWxsLU1pbmlMTS1MNi12MlwiLFxyXG4gIEdFTUlOSV9NT0RFTDogcHJvY2Vzcy5lbnYuR0VNSU5JX01PREVMIHx8IFwiZ2VtaW5pLTIuMC1mbGFzaC1leHBcIixcclxuICBURU1QRVJBVFVSRTogTnVtYmVyKHByb2Nlc3MuZW52LlRFTVBFUkFUVVJFIHx8IDAuNyksXHJcbiAgTUFYX09VVFBVVF9UT0tFTlM6IE51bWJlcihwcm9jZXNzLmVudi5NQVhfT1VUUFVUX1RPS0VOUyB8fCAyMDQ4KSxcclxuICBFTkFCTEVfT0NSOiBTdHJpbmcocHJvY2Vzcy5lbnYuRU5BQkxFX09DUiB8fCBcInRydWVcIikgPT09IFwidHJ1ZVwiLFxyXG4gIEVOQUJMRV9ZT1VUVUJFOiBTdHJpbmcocHJvY2Vzcy5lbnYuRU5BQkxFX1lPVVRVQkUgfHwgXCJ0cnVlXCIpID09PSBcInRydWVcIixcclxuICBNT05HT0RCX1VSSTogcHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkgfHwgXCJtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3XCIsXHJcbiAgTU9OR09EQl9EQl9OQU1FOiBwcm9jZXNzLmVudi5NT05HT0RCX0RCX05BTUUgfHwgXCJkb2NzLWNoYXRcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBTWVNURU1fUFJPTVBUID0gYFlvdSBhcmUgYSBoZWxwZnVsIGFzc2lzdGFudCB0aGF0IGFuc3dlcnMgcXVlc3Rpb25zIGJhc2VkIG9uIHRoZSBwcm92aWRlZCBkb2N1bWVudCBjb250ZXh0IGFuZCBhbnkgaW1hZ2VzIHByb3ZpZGVkLlxyXG5XaGVuIGFuc3dlcmluZzpcclxuMS4gVXNlIHRoZSBkb2N1bWVudCBjb250ZXh0IHByb3ZpZGVkIHRvIGFuc3dlciB0aGUgcXVlc3Rpb24gYXMgYWNjdXJhdGVseSBhcyBwb3NzaWJsZVxyXG4yLiBJZiBpbWFnZXMgYXJlIHByb3ZpZGVkLCBhbmFseXplIHRoZW0gY2FyZWZ1bGx5IGFuZCBkZXNjcmliZSB3aGF0IHlvdSBzZWVcclxuMy4gSWYgdGhlIGluZm9ybWF0aW9uIGlzIHBhcnRpYWxseSBhdmFpbGFibGUgaW4gdGhlIGNvbnRleHQsIHByb3ZpZGUgd2hhdCB5b3UgY2FuIGZpbmQgYW5kIG1lbnRpb24gd2hhdCBtaWdodCBiZSBtaXNzaW5nXHJcbjQuIElmIHRoZSBhbnN3ZXIgY2Fubm90IGJlIGZvdW5kIGluIHRoZSBwcm92aWRlZCBjb250ZXh0IG9yIGltYWdlcywgY2xlYXJseSBzdGF0ZSB0aGF0IHRoZSBzcGVjaWZpYyBpbmZvcm1hdGlvbiBpcyBub3QgYXZhaWxhYmxlXHJcbjUuIEJlIGhlbHBmdWwgYW5kIHByb3ZpZGUgcmVsZXZhbnQgaW5mb3JtYXRpb24gZXZlbiBpZiBpdCdzIG5vdCBhbiBleGFjdCBtYXRjaCB0byB0aGUgcXVlc3Rpb25cclxuNi4gQWx3YXlzIGNpdGUgd2hpY2ggcGFydCBvZiB0aGUgZG9jdW1lbnQgb3IgaW1hZ2UgeW91J3JlIHJlZmVyZW5jaW5nIHdoZW4gcG9zc2libGVgO1xyXG5cclxuIl0sIm5hbWVzIjpbInNldHRpbmdzIiwiR0VNSU5JX0FQSV9LRVkiLCJwcm9jZXNzIiwiZW52IiwiTUFYX0NIVU5LX1NJWkUiLCJOdW1iZXIiLCJDSFVOS19PVkVSTEFQIiwiTUFYX0ZJTEVfU0laRV9NQiIsIkVNQkVERElOR19NT0RFTCIsIkdFTUlOSV9NT0RFTCIsIlRFTVBFUkFUVVJFIiwiTUFYX09VVFBVVF9UT0tFTlMiLCJFTkFCTEVfT0NSIiwiU3RyaW5nIiwiRU5BQkxFX1lPVVRVQkUiLCJNT05HT0RCX1VSSSIsIk1PTkdPREJfREJfTkFNRSIsIlNZU1RFTV9QUk9NUFQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/settings.ts\n");

/***/ }),

/***/ "(rsc)/./lib/textChunker.ts":
/*!****************************!*\
  !*** ./lib/textChunker.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TextChunker: () => (/* binding */ TextChunker)\n/* harmony export */ });\nclass TextChunker {\n    constructor(chunkSize = 1000, overlap = 200){\n        this.chunkSize = chunkSize;\n        this.overlap = overlap;\n    }\n    chunkBySentences(text, maxChunkSize) {\n        const limit = maxChunkSize ?? this.chunkSize;\n        const sentences = text.replace(/!/g, \".\").replace(/\\?/g, \".\").split(\".\").map((s)=>s.trim()).filter(Boolean);\n        const chunks = [];\n        let current = [];\n        let size = 0;\n        let id = 0;\n        for (const sentence of sentences){\n            const sentSize = sentence.split(/\\s+/).length;\n            if (size + sentSize > limit && current.length) {\n                chunks.push({\n                    id,\n                    text: current.join(\". \") + \".\",\n                    sentence_count: current.length,\n                    token_count: size\n                });\n                id += 1;\n                if (this.overlap > 0 && current.length > 1) {\n                    current = current.slice(-1);\n                    size = current[0].split(/\\s+/).length;\n                } else {\n                    current = [];\n                    size = 0;\n                }\n            }\n            current.push(sentence);\n            size += sentSize;\n        }\n        if (current.length) {\n            chunks.push({\n                id,\n                text: current.join(\". \") + \".\",\n                sentence_count: current.length,\n                token_count: size\n            });\n        }\n        return chunks;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdGV4dENodW5rZXIudHMiLCJtYXBwaW5ncyI6Ijs7OztBQVNPLE1BQU1BO0lBSVhDLFlBQVlDLFlBQW9CLElBQUksRUFBRUMsVUFBa0IsR0FBRyxDQUFFO1FBQzNELElBQUksQ0FBQ0QsU0FBUyxHQUFHQTtRQUNqQixJQUFJLENBQUNDLE9BQU8sR0FBR0E7SUFDakI7SUFFQUMsaUJBQWlCQyxJQUFZLEVBQUVDLFlBQXFCLEVBQVc7UUFDN0QsTUFBTUMsUUFBUUQsZ0JBQWdCLElBQUksQ0FBQ0osU0FBUztRQUM1QyxNQUFNTSxZQUFZSCxLQUFLSSxPQUFPLENBQUMsTUFBTSxLQUFLQSxPQUFPLENBQUMsT0FBTyxLQUFLQyxLQUFLLENBQUMsS0FBS0MsR0FBRyxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFQyxJQUFJLElBQUlDLE1BQU0sQ0FBQ0M7UUFDbkcsTUFBTUMsU0FBa0IsRUFBRTtRQUMxQixJQUFJQyxVQUFvQixFQUFFO1FBQzFCLElBQUlDLE9BQU87UUFDWCxJQUFJQyxLQUFLO1FBRVQsS0FBSyxNQUFNQyxZQUFZWixVQUFXO1lBQ2hDLE1BQU1hLFdBQVdELFNBQVNWLEtBQUssQ0FBQyxPQUFPWSxNQUFNO1lBQzdDLElBQUlKLE9BQU9HLFdBQVdkLFNBQVNVLFFBQVFLLE1BQU0sRUFBRTtnQkFDN0NOLE9BQU9PLElBQUksQ0FBQztvQkFBRUo7b0JBQUlkLE1BQU1ZLFFBQVFPLElBQUksQ0FBQyxRQUFRO29CQUFLQyxnQkFBZ0JSLFFBQVFLLE1BQU07b0JBQUVJLGFBQWFSO2dCQUFLO2dCQUNwR0MsTUFBTTtnQkFDTixJQUFJLElBQUksQ0FBQ2hCLE9BQU8sR0FBRyxLQUFLYyxRQUFRSyxNQUFNLEdBQUcsR0FBRztvQkFDMUNMLFVBQVVBLFFBQVFVLEtBQUssQ0FBQyxDQUFDO29CQUN6QlQsT0FBT0QsT0FBTyxDQUFDLEVBQUUsQ0FBQ1AsS0FBSyxDQUFDLE9BQU9ZLE1BQU07Z0JBQ3ZDLE9BQU87b0JBQ0xMLFVBQVUsRUFBRTtvQkFDWkMsT0FBTztnQkFDVDtZQUNGO1lBQ0FELFFBQVFNLElBQUksQ0FBQ0g7WUFDYkYsUUFBUUc7UUFDVjtRQUNBLElBQUlKLFFBQVFLLE1BQU0sRUFBRTtZQUNsQk4sT0FBT08sSUFBSSxDQUFDO2dCQUFFSjtnQkFBSWQsTUFBTVksUUFBUU8sSUFBSSxDQUFDLFFBQVE7Z0JBQUtDLGdCQUFnQlIsUUFBUUssTUFBTTtnQkFBRUksYUFBYVI7WUFBSztRQUN0RztRQUNBLE9BQU9GO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2RvY3MtY2hhdC1uZXh0Ly4vbGliL3RleHRDaHVua2VyLnRzPzc4NDAiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHR5cGUgQ2h1bmsgPSB7XHJcbiAgaWQ6IG51bWJlcjtcclxuICB0ZXh0OiBzdHJpbmc7XHJcbiAgdG9rZW5fY291bnQ/OiBudW1iZXI7XHJcbiAgc2VudGVuY2VfY291bnQ/OiBudW1iZXI7XHJcbiAgc3RhcnRfcG9zPzogbnVtYmVyO1xyXG4gIGVuZF9wb3M/OiBudW1iZXI7XHJcbn07XHJcblxyXG5leHBvcnQgY2xhc3MgVGV4dENodW5rZXIge1xyXG4gIHByaXZhdGUgY2h1bmtTaXplOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBvdmVybGFwOiBudW1iZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNodW5rU2l6ZTogbnVtYmVyID0gMTAwMCwgb3ZlcmxhcDogbnVtYmVyID0gMjAwKSB7XHJcbiAgICB0aGlzLmNodW5rU2l6ZSA9IGNodW5rU2l6ZTtcclxuICAgIHRoaXMub3ZlcmxhcCA9IG92ZXJsYXA7XHJcbiAgfVxyXG5cclxuICBjaHVua0J5U2VudGVuY2VzKHRleHQ6IHN0cmluZywgbWF4Q2h1bmtTaXplPzogbnVtYmVyKTogQ2h1bmtbXSB7XHJcbiAgICBjb25zdCBsaW1pdCA9IG1heENodW5rU2l6ZSA/PyB0aGlzLmNodW5rU2l6ZTtcclxuICAgIGNvbnN0IHNlbnRlbmNlcyA9IHRleHQucmVwbGFjZSgvIS9nLCBcIi5cIikucmVwbGFjZSgvXFw/L2csIFwiLlwiKS5zcGxpdChcIi5cIikubWFwKHMgPT4gcy50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcclxuICAgIGNvbnN0IGNodW5rczogQ2h1bmtbXSA9IFtdO1xyXG4gICAgbGV0IGN1cnJlbnQ6IHN0cmluZ1tdID0gW107XHJcbiAgICBsZXQgc2l6ZSA9IDA7XHJcbiAgICBsZXQgaWQgPSAwO1xyXG5cclxuICAgIGZvciAoY29uc3Qgc2VudGVuY2Ugb2Ygc2VudGVuY2VzKSB7XHJcbiAgICAgIGNvbnN0IHNlbnRTaXplID0gc2VudGVuY2Uuc3BsaXQoL1xccysvKS5sZW5ndGg7XHJcbiAgICAgIGlmIChzaXplICsgc2VudFNpemUgPiBsaW1pdCAmJiBjdXJyZW50Lmxlbmd0aCkge1xyXG4gICAgICAgIGNodW5rcy5wdXNoKHsgaWQsIHRleHQ6IGN1cnJlbnQuam9pbignLiAnKSArICcuJywgc2VudGVuY2VfY291bnQ6IGN1cnJlbnQubGVuZ3RoLCB0b2tlbl9jb3VudDogc2l6ZSB9KTtcclxuICAgICAgICBpZCArPSAxO1xyXG4gICAgICAgIGlmICh0aGlzLm92ZXJsYXAgPiAwICYmIGN1cnJlbnQubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQuc2xpY2UoLTEpO1xyXG4gICAgICAgICAgc2l6ZSA9IGN1cnJlbnRbMF0uc3BsaXQoL1xccysvKS5sZW5ndGg7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGN1cnJlbnQgPSBbXTtcclxuICAgICAgICAgIHNpemUgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBjdXJyZW50LnB1c2goc2VudGVuY2UpO1xyXG4gICAgICBzaXplICs9IHNlbnRTaXplO1xyXG4gICAgfVxyXG4gICAgaWYgKGN1cnJlbnQubGVuZ3RoKSB7XHJcbiAgICAgIGNodW5rcy5wdXNoKHsgaWQsIHRleHQ6IGN1cnJlbnQuam9pbignLiAnKSArICcuJywgc2VudGVuY2VfY291bnQ6IGN1cnJlbnQubGVuZ3RoLCB0b2tlbl9jb3VudDogc2l6ZSB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBjaHVua3M7XHJcbiAgfVxyXG59XHJcblxyXG4iXSwibmFtZXMiOlsiVGV4dENodW5rZXIiLCJjb25zdHJ1Y3RvciIsImNodW5rU2l6ZSIsIm92ZXJsYXAiLCJjaHVua0J5U2VudGVuY2VzIiwidGV4dCIsIm1heENodW5rU2l6ZSIsImxpbWl0Iiwic2VudGVuY2VzIiwicmVwbGFjZSIsInNwbGl0IiwibWFwIiwicyIsInRyaW0iLCJmaWx0ZXIiLCJCb29sZWFuIiwiY2h1bmtzIiwiY3VycmVudCIsInNpemUiLCJpZCIsInNlbnRlbmNlIiwic2VudFNpemUiLCJsZW5ndGgiLCJwdXNoIiwiam9pbiIsInNlbnRlbmNlX2NvdW50IiwidG9rZW5fY291bnQiLCJzbGljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/textChunker.ts\n");

/***/ }),

/***/ "(rsc)/./lib/vectorStore.ts":
/*!****************************!*\
  !*** ./lib/vectorStore.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VectorStore: () => (/* binding */ VectorStore)\n/* harmony export */ });\n/* harmony import */ var _xenova_transformers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @xenova/transformers */ \"(rsc)/./node_modules/@xenova/transformers/src/transformers.js\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_1__);\n\n\nclass VectorStore {\n    constructor(modelName, mongoUri, dbName){\n        this.chunks = [];\n        this.embeddings = [];\n        this.embedderPromise = null;\n        this.client = null;\n        this.db = null;\n        this.collection = null;\n        this.isConnected = false;\n        this.modelName = modelName;\n        this.useMongo = Boolean(mongoUri);\n        if (mongoUri) {\n            this.client = new mongodb__WEBPACK_IMPORTED_MODULE_1__.MongoClient(mongoUri);\n            this.initMongo(dbName || \"docs-chat\").catch((err)=>{\n                console.error(\"Failed to initialize MongoDB:\", err);\n            });\n        }\n    }\n    async initMongo(dbName) {\n        try {\n            if (!this.client) {\n                console.warn(\"MongoDB client not initialized\");\n                this.isConnected = false;\n                return;\n            }\n            await this.client.connect();\n            this.db = this.client.db(dbName);\n            this.collection = this.db.collection(\"chunks\");\n            // Create index on id for faster lookups\n            try {\n                await this.collection.createIndex({\n                    id: 1\n                });\n            } catch (idxErr) {\n                // Index might already exist, that's okay\n                console.log(\"Index creation note:\", idxErr);\n            }\n            this.isConnected = true;\n            console.log(`Connected to MongoDB database: ${dbName}`);\n            await this.loadFromMongo();\n        } catch (err) {\n            console.error(\"MongoDB connection error:\", err.message || err);\n            console.warn(\"Falling back to in-memory storage. Data will not persist.\");\n            this.isConnected = false;\n        // Continue with in-memory mode - the app will still work\n        }\n    }\n    async loadFromMongo() {\n        if (!this.collection || !this.isConnected) {\n            console.log(\"Skipping MongoDB load - not connected\");\n            return;\n        }\n        try {\n            const documents = await this.collection.find({}).sort({\n                id: 1\n            }).toArray();\n            // Only load if we don't already have chunks in memory (to avoid overwriting)\n            if (this.chunks.length === 0 && documents.length > 0) {\n                this.chunks = documents.map((doc)=>({\n                        id: doc.id,\n                        text: doc.text\n                    }));\n                this.embeddings = documents.map((doc)=>new Float32Array(doc.embedding));\n                console.log(`Loaded ${this.chunks.length} chunks from MongoDB`);\n            } else if (this.chunks.length > 0) {\n                console.log(`Skipping MongoDB load - already have ${this.chunks.length} chunks in memory`);\n            } else {\n                console.log(\"No chunks in MongoDB to load\");\n            }\n        } catch (err) {\n            console.error(\"Failed to load from MongoDB:\", err);\n        }\n    }\n    async getEmbedder() {\n        if (!this.embedderPromise) {\n            const model = this.modelName.includes(\"/\") ? this.modelName : `Xenova/${this.modelName}`;\n            this.embedderPromise = (0,_xenova_transformers__WEBPACK_IMPORTED_MODULE_0__.pipeline)(\"feature-extraction\", model);\n        }\n        return this.embedderPromise;\n    }\n    async addDocuments(chunks) {\n        if (!chunks.length) {\n            console.warn(\"addDocuments called with empty chunks array\");\n            return;\n        }\n        console.log(`Adding ${chunks.length} chunks to vector store. Current chunks: ${this.chunks.length}`);\n        const embedder = await this.getEmbedder();\n        const texts = chunks.map((c)=>c.text);\n        const outputs = await embedder(texts, {\n            pooling: \"mean\",\n            normalize: true\n        });\n        const vectors = outputs.tolist().map((row)=>new Float32Array(row));\n        // Determine starting ID\n        const startId = this.chunks.length > 0 ? Math.max(...this.chunks.map((c)=>c.id)) + 1 : 0;\n        const chunksWithIds = chunks.map((chunk, i)=>({\n                ...chunk,\n                id: startId + i\n            }));\n        // Add to memory FIRST (this ensures in-memory mode works even if MongoDB fails)\n        this.chunks.push(...chunksWithIds);\n        this.embeddings.push(...vectors);\n        console.log(`Added ${chunksWithIds.length} chunks to memory. Total chunks now: ${this.chunks.length}`);\n        // Save to MongoDB if connected (this is optional - memory storage is primary)\n        if (this.collection && this.isConnected) {\n            try {\n                const documents = chunksWithIds.map((chunk, i)=>({\n                        id: chunk.id,\n                        text: chunk.text,\n                        embedding: Array.from(vectors[i]),\n                        createdAt: new Date()\n                    }));\n                await this.collection.insertMany(documents);\n                console.log(`Saved ${documents.length} chunks to MongoDB`);\n            } catch (err) {\n                console.error(\"Failed to save to MongoDB (continuing with in-memory storage):\", err);\n            // Continue even if MongoDB save fails - memory storage is already done\n            }\n        } else {\n            console.log(`MongoDB not connected (isConnected: ${this.isConnected}), using in-memory storage only`);\n        }\n    }\n    async search(query, topK = 5) {\n        if (this.chunks.length === 0) return [];\n        const embedder = await this.getEmbedder();\n        const out = await embedder(query, {\n            pooling: \"mean\",\n            normalize: true\n        });\n        const q = new Float32Array(out.tolist()[0]);\n        // Calculate cosine similarity for all embeddings\n        const scores = this.embeddings.map((v)=>cosineSimilarity(q, v));\n        // Sort by score and get top K\n        const indices = scores.map((s, i)=>[\n                s,\n                i\n            ]).sort((a, b)=>b[0] - a[0]).slice(0, Math.min(topK, scores.length));\n        return indices.map(([score, i])=>({\n                chunk: this.chunks[i],\n                score\n            }));\n    }\n    async clear() {\n        this.chunks = [];\n        this.embeddings = [];\n        if (this.collection && this.isConnected) {\n            try {\n                const result = await this.collection.deleteMany({});\n                console.log(`Cleared ${result.deletedCount} chunks from MongoDB`);\n            } catch (err) {\n                console.error(\"Failed to clear MongoDB:\", err);\n            // Continue even if MongoDB clear fails - memory is already cleared\n            }\n        }\n    }\n    getStats() {\n        return {\n            total_chunks: this.chunks.length,\n            dimension: this.embeddings[0]?.length || 0,\n            model_name: this.modelName,\n            index_size: this.embeddings.length\n        };\n    }\n    async close() {\n        if (this.client && this.isConnected) {\n            await this.client.close();\n            this.isConnected = false;\n        }\n    }\n}\nfunction cosineSimilarity(a, b) {\n    let dot = 0;\n    let na = 0;\n    let nb = 0;\n    for(let i = 0; i < a.length && i < b.length; i++){\n        dot += a[i] * b[i];\n        na += a[i] * a[i];\n        nb += b[i] * b[i];\n    }\n    if (na === 0 || nb === 0) return 0;\n    return dot / (Math.sqrt(na) * Math.sqrt(nb));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxNQUFNaEIsQ0FBQyxDQUFDbEIsRUFBRSxHQUFHa0IsQ0FBQyxDQUFDbEIsRUFBRTtJQUNuQjtJQUNBLElBQUlpQyxPQUFPLEtBQUtDLE9BQU8sR0FBRyxPQUFPO0lBQ2pDLE9BQU9GLE1BQU9wQyxDQUFBQSxLQUFLdUMsSUFBSSxDQUFDRixNQUFNckMsS0FBS3VDLElBQUksQ0FBQ0QsR0FBRTtBQUM1QyIsInNvdXJjZXMiOlsid2VicGFjazovL2RvY3MtY2hhdC1uZXh0Ly4vbGliL3ZlY3RvclN0b3JlLnRzPzQzMzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcGlwZWxpbmUgfSBmcm9tIFwiQHhlbm92YS90cmFuc2Zvcm1lcnNcIjtcclxuaW1wb3J0IHR5cGUgeyBDaHVuayB9IGZyb20gXCIuL3RleHRDaHVua2VyXCI7XHJcbmltcG9ydCB7IE1vbmdvQ2xpZW50LCBEYiwgQ29sbGVjdGlvbiB9IGZyb20gXCJtb25nb2RiXCI7XHJcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcclxuXHJcbnR5cGUgRW1iZWRkaW5nID0gRmxvYXQzMkFycmF5O1xyXG5cclxuaW50ZXJmYWNlIENodW5rRG9jdW1lbnQge1xyXG4gIGlkOiBudW1iZXI7XHJcbiAgdGV4dDogc3RyaW5nO1xyXG4gIGVtYmVkZGluZzogbnVtYmVyW107XHJcbiAgY3JlYXRlZEF0OiBEYXRlO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVmVjdG9yU3RvcmUge1xyXG4gIHByaXZhdGUgY2h1bmtzOiBDaHVua1tdID0gW107XHJcbiAgcHJpdmF0ZSBlbWJlZGRpbmdzOiBFbWJlZGRpbmdbXSA9IFtdO1xyXG4gIHByaXZhdGUgZW1iZWRkZXJQcm9taXNlOiBQcm9taXNlPGFueT4gfCBudWxsID0gbnVsbDtcclxuICBwcml2YXRlIG1vZGVsTmFtZTogc3RyaW5nO1xyXG4gIHByaXZhdGUgY2xpZW50OiBNb25nb0NsaWVudCB8IG51bGwgPSBudWxsO1xyXG4gIHByaXZhdGUgZGI6IERiIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBjb2xsZWN0aW9uOiBDb2xsZWN0aW9uPENodW5rRG9jdW1lbnQ+IHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSB1c2VNb25nbzogYm9vbGVhbjtcclxuICBwcml2YXRlIGlzQ29ubmVjdGVkOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gIGNvbnN0cnVjdG9yKG1vZGVsTmFtZTogc3RyaW5nLCBtb25nb1VyaT86IHN0cmluZywgZGJOYW1lPzogc3RyaW5nKSB7XHJcbiAgICB0aGlzLm1vZGVsTmFtZSA9IG1vZGVsTmFtZTtcclxuICAgIHRoaXMudXNlTW9uZ28gPSBCb29sZWFuKG1vbmdvVXJpKTtcclxuICAgIFxyXG4gICAgaWYgKG1vbmdvVXJpKSB7XHJcbiAgICAgIHRoaXMuY2xpZW50ID0gbmV3IE1vbmdvQ2xpZW50KG1vbmdvVXJpKTtcclxuICAgICAgdGhpcy5pbml0TW9uZ28oZGJOYW1lIHx8IFwiZG9jcy1jaGF0XCIpLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGluaXRpYWxpemUgTW9uZ29EQjpcIiwgZXJyKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGluaXRNb25nbyhkYk5hbWU6IHN0cmluZykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKCF0aGlzLmNsaWVudCkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihcIk1vbmdvREIgY2xpZW50IG5vdCBpbml0aWFsaXplZFwiKTtcclxuICAgICAgICB0aGlzLmlzQ29ubmVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBhd2FpdCB0aGlzLmNsaWVudC5jb25uZWN0KCk7XHJcbiAgICAgIHRoaXMuZGIgPSB0aGlzLmNsaWVudC5kYihkYk5hbWUpO1xyXG4gICAgICB0aGlzLmNvbGxlY3Rpb24gPSB0aGlzLmRiLmNvbGxlY3Rpb248Q2h1bmtEb2N1bWVudD4oXCJjaHVua3NcIik7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDcmVhdGUgaW5kZXggb24gaWQgZm9yIGZhc3RlciBsb29rdXBzXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5jb2xsZWN0aW9uLmNyZWF0ZUluZGV4KHsgaWQ6IDEgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGlkeEVycikge1xyXG4gICAgICAgIC8vIEluZGV4IG1pZ2h0IGFscmVhZHkgZXhpc3QsIHRoYXQncyBva2F5XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJJbmRleCBjcmVhdGlvbiBub3RlOlwiLCBpZHhFcnIpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLmlzQ29ubmVjdGVkID0gdHJ1ZTtcclxuICAgICAgY29uc29sZS5sb2coYENvbm5lY3RlZCB0byBNb25nb0RCIGRhdGFiYXNlOiAke2RiTmFtZX1gKTtcclxuICAgICAgYXdhaXQgdGhpcy5sb2FkRnJvbU1vbmdvKCk7XHJcbiAgICB9IGNhdGNoIChlcnI6IGFueSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiTW9uZ29EQiBjb25uZWN0aW9uIGVycm9yOlwiLCBlcnIubWVzc2FnZSB8fCBlcnIpO1xyXG4gICAgICBjb25zb2xlLndhcm4oXCJGYWxsaW5nIGJhY2sgdG8gaW4tbWVtb3J5IHN0b3JhZ2UuIERhdGEgd2lsbCBub3QgcGVyc2lzdC5cIik7XHJcbiAgICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBmYWxzZTtcclxuICAgICAgLy8gQ29udGludWUgd2l0aCBpbi1tZW1vcnkgbW9kZSAtIHRoZSBhcHAgd2lsbCBzdGlsbCB3b3JrXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGxvYWRGcm9tTW9uZ28oKSB7XHJcbiAgICBpZiAoIXRoaXMuY29sbGVjdGlvbiB8fCAhdGhpcy5pc0Nvbm5lY3RlZCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIlNraXBwaW5nIE1vbmdvREIgbG9hZCAtIG5vdCBjb25uZWN0ZWRcIik7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZG9jdW1lbnRzID0gYXdhaXQgdGhpcy5jb2xsZWN0aW9uLmZpbmQoe30pLnNvcnQoeyBpZDogMSB9KS50b0FycmF5KCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPbmx5IGxvYWQgaWYgd2UgZG9uJ3QgYWxyZWFkeSBoYXZlIGNodW5rcyBpbiBtZW1vcnkgKHRvIGF2b2lkIG92ZXJ3cml0aW5nKVxyXG4gICAgICBpZiAodGhpcy5jaHVua3MubGVuZ3RoID09PSAwICYmIGRvY3VtZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdGhpcy5jaHVua3MgPSBkb2N1bWVudHMubWFwKChkb2MpID0+ICh7IFxyXG4gICAgICAgICAgaWQ6IGRvYy5pZCwgXHJcbiAgICAgICAgICB0ZXh0OiBkb2MudGV4dCBcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgdGhpcy5lbWJlZGRpbmdzID0gZG9jdW1lbnRzLm1hcCgoZG9jKSA9PiBcclxuICAgICAgICAgIG5ldyBGbG9hdDMyQXJyYXkoZG9jLmVtYmVkZGluZylcclxuICAgICAgICApO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBMb2FkZWQgJHt0aGlzLmNodW5rcy5sZW5ndGh9IGNodW5rcyBmcm9tIE1vbmdvREJgKTtcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLmNodW5rcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYFNraXBwaW5nIE1vbmdvREIgbG9hZCAtIGFscmVhZHkgaGF2ZSAke3RoaXMuY2h1bmtzLmxlbmd0aH0gY2h1bmtzIGluIG1lbW9yeWApO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiTm8gY2h1bmtzIGluIE1vbmdvREIgdG8gbG9hZFwiKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBmcm9tIE1vbmdvREI6XCIsIGVycik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGdldEVtYmVkZGVyKCkge1xyXG4gICAgaWYgKCF0aGlzLmVtYmVkZGVyUHJvbWlzZSkge1xyXG4gICAgICBjb25zdCBtb2RlbCA9IHRoaXMubW9kZWxOYW1lLmluY2x1ZGVzKCcvJykgPyB0aGlzLm1vZGVsTmFtZSA6IGBYZW5vdmEvJHt0aGlzLm1vZGVsTmFtZX1gO1xyXG4gICAgICB0aGlzLmVtYmVkZGVyUHJvbWlzZSA9IHBpcGVsaW5lKFwiZmVhdHVyZS1leHRyYWN0aW9uXCIsIG1vZGVsKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLmVtYmVkZGVyUHJvbWlzZTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGFkZERvY3VtZW50cyhjaHVua3M6IENodW5rW10pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGlmICghY2h1bmtzLmxlbmd0aCkge1xyXG4gICAgICBjb25zb2xlLndhcm4oXCJhZGREb2N1bWVudHMgY2FsbGVkIHdpdGggZW1wdHkgY2h1bmtzIGFycmF5XCIpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBBZGRpbmcgJHtjaHVua3MubGVuZ3RofSBjaHVua3MgdG8gdmVjdG9yIHN0b3JlLiBDdXJyZW50IGNodW5rczogJHt0aGlzLmNodW5rcy5sZW5ndGh9YCk7XHJcbiAgICBcclxuICAgIGNvbnN0IGVtYmVkZGVyID0gYXdhaXQgdGhpcy5nZXRFbWJlZGRlcigpO1xyXG4gICAgY29uc3QgdGV4dHMgPSBjaHVua3MubWFwKGMgPT4gYy50ZXh0KTtcclxuICAgIGNvbnN0IG91dHB1dHMgPSBhd2FpdCBlbWJlZGRlcih0ZXh0cywgeyBwb29saW5nOiBcIm1lYW5cIiwgbm9ybWFsaXplOiB0cnVlIH0pO1xyXG4gICAgY29uc3QgdmVjdG9yczogRW1iZWRkaW5nW10gPSBvdXRwdXRzLnRvbGlzdCgpLm1hcCgocm93OiBudW1iZXJbXSkgPT4gbmV3IEZsb2F0MzJBcnJheShyb3cpKTtcclxuICAgIFxyXG4gICAgLy8gRGV0ZXJtaW5lIHN0YXJ0aW5nIElEXHJcbiAgICBjb25zdCBzdGFydElkID0gdGhpcy5jaHVua3MubGVuZ3RoID4gMCA/IE1hdGgubWF4KC4uLnRoaXMuY2h1bmtzLm1hcChjID0+IGMuaWQpKSArIDEgOiAwO1xyXG4gICAgY29uc3QgY2h1bmtzV2l0aElkcyA9IGNodW5rcy5tYXAoKGNodW5rLCBpKSA9PiAoeyAuLi5jaHVuaywgaWQ6IHN0YXJ0SWQgKyBpIH0pKTtcclxuICAgIFxyXG4gICAgLy8gQWRkIHRvIG1lbW9yeSBGSVJTVCAodGhpcyBlbnN1cmVzIGluLW1lbW9yeSBtb2RlIHdvcmtzIGV2ZW4gaWYgTW9uZ29EQiBmYWlscylcclxuICAgIHRoaXMuY2h1bmtzLnB1c2goLi4uY2h1bmtzV2l0aElkcyk7XHJcbiAgICB0aGlzLmVtYmVkZGluZ3MucHVzaCguLi52ZWN0b3JzKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYEFkZGVkICR7Y2h1bmtzV2l0aElkcy5sZW5ndGh9IGNodW5rcyB0byBtZW1vcnkuIFRvdGFsIGNodW5rcyBub3c6ICR7dGhpcy5jaHVua3MubGVuZ3RofWApO1xyXG4gICAgXHJcbiAgICAvLyBTYXZlIHRvIE1vbmdvREIgaWYgY29ubmVjdGVkICh0aGlzIGlzIG9wdGlvbmFsIC0gbWVtb3J5IHN0b3JhZ2UgaXMgcHJpbWFyeSlcclxuICAgIGlmICh0aGlzLmNvbGxlY3Rpb24gJiYgdGhpcy5pc0Nvbm5lY3RlZCkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRvY3VtZW50czogQ2h1bmtEb2N1bWVudFtdID0gY2h1bmtzV2l0aElkcy5tYXAoKGNodW5rLCBpKSA9PiAoe1xyXG4gICAgICAgICAgaWQ6IGNodW5rLmlkLFxyXG4gICAgICAgICAgdGV4dDogY2h1bmsudGV4dCxcclxuICAgICAgICAgIGVtYmVkZGluZzogQXJyYXkuZnJvbSh2ZWN0b3JzW2ldKSxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXdhaXQgdGhpcy5jb2xsZWN0aW9uLmluc2VydE1hbnkoZG9jdW1lbnRzKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgU2F2ZWQgJHtkb2N1bWVudHMubGVuZ3RofSBjaHVua3MgdG8gTW9uZ29EQmApO1xyXG4gICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHNhdmUgdG8gTW9uZ29EQiAoY29udGludWluZyB3aXRoIGluLW1lbW9yeSBzdG9yYWdlKTpcIiwgZXJyKTtcclxuICAgICAgICAvLyBDb250aW51ZSBldmVuIGlmIE1vbmdvREIgc2F2ZSBmYWlscyAtIG1lbW9yeSBzdG9yYWdlIGlzIGFscmVhZHkgZG9uZVxyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmxvZyhgTW9uZ29EQiBub3QgY29ubmVjdGVkIChpc0Nvbm5lY3RlZDogJHt0aGlzLmlzQ29ubmVjdGVkfSksIHVzaW5nIGluLW1lbW9yeSBzdG9yYWdlIG9ubHlgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIHNlYXJjaChxdWVyeTogc3RyaW5nLCB0b3BLOiBudW1iZXIgPSA1KTogUHJvbWlzZTx7IGNodW5rOiBDaHVuazsgc2NvcmU6IG51bWJlciB9W10+IHtcclxuICAgIGlmICh0aGlzLmNodW5rcy5sZW5ndGggPT09IDApIHJldHVybiBbXTtcclxuICAgIFxyXG4gICAgY29uc3QgZW1iZWRkZXIgPSBhd2FpdCB0aGlzLmdldEVtYmVkZGVyKCk7XHJcbiAgICBjb25zdCBvdXQgPSBhd2FpdCBlbWJlZGRlcihxdWVyeSwgeyBwb29saW5nOiBcIm1lYW5cIiwgbm9ybWFsaXplOiB0cnVlIH0pO1xyXG4gICAgY29uc3QgcSA9IG5ldyBGbG9hdDMyQXJyYXkob3V0LnRvbGlzdCgpWzBdKTtcclxuICAgIFxyXG4gICAgLy8gQ2FsY3VsYXRlIGNvc2luZSBzaW1pbGFyaXR5IGZvciBhbGwgZW1iZWRkaW5nc1xyXG4gICAgY29uc3Qgc2NvcmVzID0gdGhpcy5lbWJlZGRpbmdzLm1hcCgodikgPT4gY29zaW5lU2ltaWxhcml0eShxLCB2KSk7XHJcbiAgICBcclxuICAgIC8vIFNvcnQgYnkgc2NvcmUgYW5kIGdldCB0b3AgS1xyXG4gICAgY29uc3QgaW5kaWNlcyA9IHNjb3Jlc1xyXG4gICAgICAubWFwKChzLCBpKSA9PiBbcywgaV0gYXMgY29uc3QpXHJcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiWzBdIC0gYVswXSlcclxuICAgICAgLnNsaWNlKDAsIE1hdGgubWluKHRvcEssIHNjb3Jlcy5sZW5ndGgpKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIGluZGljZXMubWFwKChbc2NvcmUsIGldKSA9PiAoeyBcclxuICAgICAgY2h1bms6IHRoaXMuY2h1bmtzW2ldLCBcclxuICAgICAgc2NvcmUgXHJcbiAgICB9KSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBjbGVhcigpIHtcclxuICAgIHRoaXMuY2h1bmtzID0gW107XHJcbiAgICB0aGlzLmVtYmVkZGluZ3MgPSBbXTtcclxuICAgIFxyXG4gICAgaWYgKHRoaXMuY29sbGVjdGlvbiAmJiB0aGlzLmlzQ29ubmVjdGVkKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jb2xsZWN0aW9uLmRlbGV0ZU1hbnkoe30pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBDbGVhcmVkICR7cmVzdWx0LmRlbGV0ZWRDb3VudH0gY2h1bmtzIGZyb20gTW9uZ29EQmApO1xyXG4gICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNsZWFyIE1vbmdvREI6XCIsIGVycik7XHJcbiAgICAgICAgLy8gQ29udGludWUgZXZlbiBpZiBNb25nb0RCIGNsZWFyIGZhaWxzIC0gbWVtb3J5IGlzIGFscmVhZHkgY2xlYXJlZFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRTdGF0cygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRvdGFsX2NodW5rczogdGhpcy5jaHVua3MubGVuZ3RoLFxyXG4gICAgICBkaW1lbnNpb246IHRoaXMuZW1iZWRkaW5nc1swXT8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgIG1vZGVsX25hbWU6IHRoaXMubW9kZWxOYW1lLFxyXG4gICAgICBpbmRleF9zaXplOiB0aGlzLmVtYmVkZGluZ3MubGVuZ3RoLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGNsb3NlKCkge1xyXG4gICAgaWYgKHRoaXMuY2xpZW50ICYmIHRoaXMuaXNDb25uZWN0ZWQpIHtcclxuICAgICAgYXdhaXQgdGhpcy5jbGllbnQuY2xvc2UoKTtcclxuICAgICAgdGhpcy5pc0Nvbm5lY3RlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY29zaW5lU2ltaWxhcml0eShhOiBGbG9hdDMyQXJyYXksIGI6IEZsb2F0MzJBcnJheSk6IG51bWJlciB7XHJcbiAgbGV0IGRvdCA9IDA7XHJcbiAgbGV0IG5hID0gMDtcclxuICBsZXQgbmIgPSAwO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYS5sZW5ndGggJiYgaSA8IGIubGVuZ3RoOyBpKyspIHtcclxuICAgIGRvdCArPSBhW2ldICogYltpXTtcclxuICAgIG5hICs9IGFbaV0gKiBhW2ldO1xyXG4gICAgbmIgKz0gYltpXSAqIGJbaV07XHJcbiAgfVxyXG4gIGlmIChuYSA9PT0gMCB8fCBuYiA9PT0gMCkgcmV0dXJuIDA7XHJcbiAgcmV0dXJuIGRvdCAvIChNYXRoLnNxcnQobmEpICogTWF0aC5zcXJ0KG5iKSk7XHJcbn1cclxuIl0sIm5hbWVzIjpbInBpcGVsaW5lIiwiTW9uZ29DbGllbnQiLCJWZWN0b3JTdG9yZSIsImNvbnN0cnVjdG9yIiwibW9kZWxOYW1lIiwibW9uZ29VcmkiLCJkYk5hbWUiLCJjaHVua3MiLCJlbWJlZGRpbmdzIiwiZW1iZWRkZXJQcm9taXNlIiwiY2xpZW50IiwiZGIiLCJjb2xsZWN0aW9uIiwiaXNDb25uZWN0ZWQiLCJ1c2VNb25nbyIsIkJvb2xlYW4iLCJpbml0TW9uZ28iLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsIndhcm4iLCJjb25uZWN0IiwiY3JlYXRlSW5kZXgiLCJpZCIsImlkeEVyciIsImxvZyIsImxvYWRGcm9tTW9uZ28iLCJtZXNzYWdlIiwiZG9jdW1lbnRzIiwiZmluZCIsInNvcnQiLCJ0b0FycmF5IiwibGVuZ3RoIiwibWFwIiwiZG9jIiwidGV4dCIsIkZsb2F0MzJBcnJheSIsImVtYmVkZGluZyIsImdldEVtYmVkZGVyIiwibW9kZWwiLCJpbmNsdWRlcyIsImFkZERvY3VtZW50cyIsImVtYmVkZGVyIiwidGV4dHMiLCJjIiwib3V0cHV0cyIsInBvb2xpbmciLCJub3JtYWxpemUiLCJ2ZWN0b3JzIiwidG9saXN0Iiwicm93Iiwic3RhcnRJZCIsIk1hdGgiLCJtYXgiLCJjaHVua3NXaXRoSWRzIiwiY2h1bmsiLCJpIiwicHVzaCIsIkFycmF5IiwiZnJvbSIsImNyZWF0ZWRBdCIsIkRhdGUiLCJpbnNlcnRNYW55Iiwic2VhcmNoIiwicXVlcnkiLCJ0b3BLIiwib3V0IiwicSIsInNjb3JlcyIsInYiLCJjb3NpbmVTaW1pbGFyaXR5IiwiaW5kaWNlcyIsInMiLCJhIiwiYiIsInNsaWNlIiwibWluIiwic2NvcmUiLCJjbGVhciIsInJlc3VsdCIsImRlbGV0ZU1hbnkiLCJkZWxldGVkQ291bnQiLCJnZXRTdGF0cyIsInRvdGFsX2NodW5rcyIsImRpbWVuc2lvbiIsIm1vZGVsX25hbWUiLCJpbmRleF9zaXplIiwiY2xvc2UiLCJkb3QiLCJuYSIsIm5iIiwic3FydCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/vectorStore.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@xenova","vendor-chunks/onnxruntime-web","vendor-chunks/@huggingface","vendor-chunks/onnxruntime-common"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsession%2Fnew%2Froute&page=%2Fapi%2Fsession%2Fnew%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsession%2Fnew%2Froute.ts&appDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Ckomar%5CDesktop%5Cdocs-chat-master%5Cdocs-chat-master&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();